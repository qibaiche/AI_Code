# Mole 配置 UI - 快速开始指南

## 🚀 5 分钟快速上手

### 步骤 1: 准备文件

确保以下文件存在：

```
automation/auto-vpo/
├── input/
│   ├── Source Lot.csv          ← 必需
│   └── MIR Comments.txt        ← 可选
└── workflow_automation/
    └── config.yaml             ← 自动创建
```

**Source Lot.csv 示例**:
```csv
SourceLot,Part Type,Quantity,Operation,EngID,HRI / MRV,Unit test time,Retest rate
PTPB5TPI206,43 4PLH2V E B,46,6248,AF,,500,100
PTPB5TPI501,43 4PXA5V E B,70,6248,AF,,500,100
```

### 步骤 2: 运行程序

双击运行：
```
1-测试Mole.bat
```

### 步骤 3: 配置参数

配置 UI 会自动弹出：

```
┌─────────────────────────────────────────┐
│         Mole 自动化配置                  │
├─────────────────────────────────────────┤
│ 选择搜索方式:                            │
│  ● Search By VPOs         ← 选择这个     │
│  ○ Search By Units                      │
│  ○ Search Inactive Cage                 │
├─────────────────────────────────────────┤
│ 公共参数:                                │
│  Product Code: [____________]  ← 可选    │
│  Source Lot:   [____________]  ← 可选    │
├─────────────────────────────────────────┤
│ VPOs 参数:                               │
│  Fuse:      [____________]     ← 可选    │
│  Part Type: [____________]     ← 可选    │
├─────────────────────────────────────────┤
│ [重置为默认值]    [取消]    [确定]       │
└─────────────────────────────────────────┘
```

**建议配置**:
- **首次使用**: 所有字段留空，使用默认值
- **批量处理**: 填写公共参数，程序会应用到所有行

### 步骤 4: 开始执行

点击 **[确定]** 按钮，程序会：

1. ✅ 保存配置
2. ✅ 启动 Mole 工具
3. ✅ 读取 Source Lot.csv
4. ✅ 循环处理每一行
5. ✅ 生成 MIR 结果文件

### 步骤 5: 查看结果

结果文件位于：
```
automation/auto-vpo/output/MIR_Results_YYYYMMDD_HHMMSS.csv
```

**示例输出**:
```csv
SourceLot,Part Type,Quantity,Operation,EngID,HRI / MRV,Unit test time,Retest rate,MIR
PTPB5TPI206,43 4PLH2V E B,46,6248,AF,,500,100,MIR12345
PTPB5TPI501,43 4PXA5V E B,70,6248,AF,,500,100,MIR12346
```

## 📝 常见使用场景

### 场景 1: 使用默认配置（推荐新手）

1. 运行 `1-测试Mole.bat`
2. 配置 UI 弹出
3. **不填写任何字段**，直接点击 **[确定]**
4. 程序使用默认的 "Search By VPOs" 模式
5. 从 Source Lot.csv 读取每行的数据

**适用于**:
- 首次使用
- 测试功能
- 每行数据不同

### 场景 2: 批量处理相同参数

1. 运行 `1-测试Mole.bat`
2. 配置 UI 弹出
3. 填写公共参数:
   - Product Code: `ABC123`
   - Source Lot: `LOT001`
4. 点击 **[确定]**
5. 程序对所有行使用相同的参数

**适用于**:
- 批量处理
- 所有行使用相同的 Product Code 或 Source Lot
- 快速测试

### 场景 3: 使用 Units 搜索

1. 运行 `1-测试Mole.bat`
2. 配置 UI 弹出
3. 选择 **Search By Units**
4. 填写参数:
   - Product Code: `XYZ789`
   - Unit Name: `UNIT_A`
   - 勾选 **Show available units only**
5. 点击 **[确定]**

**适用于**:
- 需要按 Unit 搜索的场景
- 只查看可用的 units

### 场景 4: 修改上次的配置

1. 运行 `1-测试Mole.bat`
2. 配置 UI 弹出（自动加载上次的配置）
3. 修改需要更改的字段
4. 点击 **[确定]**
5. 新配置会覆盖旧配置

**适用于**:
- 微调配置
- 重复执行类似任务
- 快速切换参数

## 🎯 使用技巧

### 技巧 1: 留空字段

**问题**: 什么时候应该留空字段？

**答案**:
- **Source Lot 留空** → 从 CSV 文件读取每行的 SourceLot 值
- **Product Code 留空** → 使用默认值或 Mole 工具的默认选择
- **其他字段留空** → 使用默认值

**示例**:
```
CSV 文件:
  Row 1: SourceLot = "LOT001"
  Row 2: SourceLot = "LOT002"

UI 配置:
  Source Lot: [留空]

结果:
  Row 1 使用 "LOT001"
  Row 2 使用 "LOT002"
```

### 技巧 2: 覆盖文件值

**问题**: 如何对所有行使用相同的 Source Lot？

**答案**: 在 UI 中填写 Source Lot

**示例**:
```
CSV 文件:
  Row 1: SourceLot = "LOT001"
  Row 2: SourceLot = "LOT002"

UI 配置:
  Source Lot: "LOT999"

结果:
  Row 1 使用 "LOT999"  ← 覆盖
  Row 2 使用 "LOT999"  ← 覆盖
```

### 技巧 3: 快速重置

**问题**: 如何清空所有输入？

**答案**: 点击 **[重置为默认值]** 按钮

**效果**:
- 所有输入框清空
- 搜索方式重置为 "Search By VPOs"
- 复选框取消勾选

### 技巧 4: 取消操作

**问题**: 如何取消配置？

**答案**: 点击 **[取消]** 按钮或关闭窗口

**效果**:
- 配置不会保存
- 工作流终止
- 程序退出

### 技巧 5: 查看配置

**问题**: 如何查看当前保存的配置？

**答案**: 打开 `workflow_automation/config.yaml`

**位置**:
```yaml
# 在文件末尾
mole_history:
  search_mode: "vpos"
  product_code: "ABC123"
  source_lot: "LOT001"
  fuse: ""
  part_type: ""
  unit_name: ""
  show_available_units: false
```

## ⚠️ 注意事项

### 1. 文件格式

**Source Lot.csv 必须包含 `SourceLot` 列**:
```csv
SourceLot,Part Type,...
PTPB5TPI206,43 4PLH2V E B,...
```

支持的列名（不区分大小写）:
- `SourceLot`
- `Source Lot`
- `Source_Lot`
- `SourceLots`
- `Source Lots`

### 2. 配置优先级

```
UI 配置 > CSV 文件 > 默认值
```

**示例**:
```
UI: Source Lot = "LOT999"
CSV: SourceLot = "LOT001"
→ 使用 "LOT999"

UI: Source Lot = [留空]
CSV: SourceLot = "LOT001"
→ 使用 "LOT001"

UI: Source Lot = [留空]
CSV: SourceLot = [空]
→ 使用默认值或跳过
```

### 3. Mole 工具状态

**程序会自动处理 Mole 工具**:
- ✅ 如果 Mole 已运行 → 连接现有窗口
- ✅ 如果 Mole 未运行 → 自动启动
- ✅ 如果登录对话框出现 → 自动点击 OK

**无需手动操作**！

### 4. 错误处理

**如果某一行处理失败**:
- ❌ 该行会被跳过
- ✅ 程序继续处理下一行
- 📝 错误信息记录在日志中

**查看日志**:
```
automation/auto-vpo/workflow_automation/logs/workflow_automation.log
```

## 🐛 故障排除

### 问题 1: UI 没有弹出

**可能原因**:
- tkinter 未安装
- config.yaml 文件损坏

**解决方案**:
1. 检查 Python 是否包含 tkinter
2. 删除 config.yaml，让程序重新生成
3. 查看日志文件获取详细错误

### 问题 2: 配置没有保存

**可能原因**:
- 点击了 [取消] 按钮
- config.yaml 文件权限问题

**解决方案**:
1. 确保点击 [确定] 按钮
2. 检查 config.yaml 文件权限
3. 手动编辑 config.yaml

### 问题 3: Mole 工具无法启动

**可能原因**:
- executable_path 配置错误
- Mole 工具未安装

**解决方案**:
1. 检查 config.yaml 中的 `mole.executable_path`
2. 确认 Mole 工具已安装
3. 手动启动 Mole 工具，程序会自动连接

### 问题 4: 搜索对话框填写失败

**可能原因**:
- Mole 工具界面变化
- 控件识别失败

**解决方案**:
1. 查看日志获取详细错误
2. 尝试手动操作 Mole 工具
3. 联系技术支持

## 📚 下一步

### 深入学习

1. **详细文档**
   - 阅读 `Mole配置UI使用说明.md`
   - 查看 `更新日志.md`
   - 参考 `功能总结.md`

2. **高级配置**
   - 编辑 `config.yaml`
   - 自定义搜索参数
   - 配置多个环境

3. **开发和扩展**
   - 查看源代码 `mole_config_ui.py`
   - 添加自定义功能
   - 贡献代码改进

### 获取帮助

- 📖 查看文档: `mole/` 目录下的所有 `.md` 文件
- 📝 查看日志: `workflow_automation/logs/workflow_automation.log`
- 🔧 检查配置: `workflow_automation/config.yaml`

---

**恭喜！您已经掌握了 Mole 配置 UI 的基本使用方法！** 🎉

如有问题，请查看详细文档或联系技术支持。

---

**版本**: 1.1.0  
**更新日期**: 2025-12-18  
**作者**: AI Code Assistant

