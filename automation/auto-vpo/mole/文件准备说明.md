# Mole 工具文件准备说明

## 📁 必需文件

### 1. Source Lot 文件

**文件名**：`Source Lot.csv` 或 `Source Lot.xlsx`

**位置**（按优先级）：
1. `automation/auto-vpo/input/Source Lot.csv`（优先，推荐）
2. `Auto VPO/Source Lot.csv`（父目录）

**文件格式**：
- CSV 文件（推荐）：`.csv`
- Excel 文件：`.xlsx` 或 `.xls`

**必需列**：
- `SourceLot` 或 `Source Lot`：Lot 名称（必需）
- `Part Type`：Part Type（必需）
- `Operation`：Operation 编号（必需）
- `Eng ID`：Engineering ID（必需）

**可选列**：
- `Unit test time`：单位测试时间
- `Retest rate`：重测率
- `HRI / MRV:`：HRI/MRV 值
- `Quantity`：数量
- 其他自定义列

**示例内容**（CSV 格式）：
```csv
SourceLot,Part Type,Operation,Eng ID,Quantity
PTPB0DOE400,PTL_P_CLASS,1234,ENG001,100
PTPB0DOE401,PTL_P_CLASS,1235,ENG002,200
```

**示例内容**（Excel 格式）：
| SourceLot | Part Type | Operation | Eng ID | Quantity |
|-----------|-----------|-----------|--------|----------|
| PTPB0DOE400 | PTL_P_CLASS | 1234 | ENG001 | 100 |
| PTPB0DOE401 | PTL_P_CLASS | 1235 | ENG002 | 200 |

## 📄 可选文件

### 2. MIR Comments 文件

**文件名**：`MIR Comments.txt`

**位置**（按优先级）：
1. `automation/auto-vpo/input/MIR Comments.txt`（优先）
2. `automation/auto-vpo/MIR Comments.txt`
3. 当前工作目录
4. `workflow_automation/MIR Comments.txt`

**文件格式**：纯文本文件（`.txt`）

**用途**：自动填写 Mole 工具中的 "Requestor Comments" 字段

**示例内容**：
```
Please bring this lot to 2524 level4
```

**注意事项**：
- 如果文件不存在，工具会跳过填写 Comments，不影响主要功能
- 文件内容会原样复制到 Requestor Comments 字段
- 支持多行文本

## 📂 目录结构示例

```
automation/auto-vpo/
├── input/                          # 输入文件目录（推荐）
│   ├── Source Lot.csv             # ✅ 必需：Source Lot 文件
│   └── MIR Comments.txt           # ⭕ 可选：MIR Comments 文件
│
├── output/                         # 输出目录（自动创建）
│   └── MIR_Results_*.csv          # 自动生成的 MIR 结果文件（位于output文件夹）
│
├── workflow_automation/
│   ├── config.yaml                # 配置文件
│   └── logs/                      # 日志目录
│       └── workflow_automation.log
│
└── mole/
    ├── README.md                  # 使用说明
    ├── 配置示例.yaml              # 配置示例
    └── 文件准备说明.md            # 本文档
```

## ✅ 文件检查清单

在运行工作流之前，请确认：

- [ ] `Source Lot.csv` 文件已准备好
- [ ] Source Lot 文件包含必需的列：`SourceLot`, `Part Type`, `Operation`, `Eng ID`
- [ ] Source Lot 文件放在正确的位置（`input/` 目录或父目录）
- [ ] （可选）`MIR Comments.txt` 文件已准备好（如果需要自动填写 Comments）
- [ ] `config.yaml` 中的 Mole 配置已正确设置
- [ ] Mole 工具可执行文件路径正确

## 🔍 文件查找逻辑

### Source Lot 文件查找顺序：

1. 配置文件中的 `paths.source_lot_file` 路径（如果配置了）
2. `automation/auto-vpo/input/Source Lot.csv`（优先，推荐）
3. `Auto VPO/Source Lot.csv`（父目录）
4. 如果都找不到，会提示用户手动选择

### MIR Comments 文件查找顺序：

1. `automation/auto-vpo/input/MIR Comments.txt`（优先）
2. `automation/auto-vpo/MIR Comments.txt`
3. 当前工作目录的 `MIR Comments.txt`
4. `workflow_automation/MIR Comments.txt`
5. 如果都找不到，会跳过填写 Comments（不影响主要功能）

## 💡 提示

1. **推荐使用 `input/` 目录**：将所有输入文件放在 `input/` 目录下，便于管理
2. **文件命名**：文件名不区分大小写，但建议使用标准命名
3. **文件编码**：CSV 文件建议使用 UTF-8 编码
4. **文件格式**：确保 CSV 文件使用逗号分隔，Excel 文件格式正确

## ❓ 常见问题

### Q: Source Lot 文件必须放在哪里？

A: 推荐放在 `input/` 目录下，也可以放在 `Auto VPO/` 根目录。工具会自动查找。

### Q: MIR Comments.txt 文件是必需的吗？

A: 不是必需的。如果文件不存在，工具会跳过填写 Comments，不影响 MIR 提交。

### Q: 可以使用 Excel 文件吗？

A: 可以。支持 `.xlsx` 和 `.xls` 格式的 Excel 文件。

### Q: Source Lot 文件的列名必须完全匹配吗？

A: 不区分大小写，但建议使用标准命名。工具会自动识别 `SourceLot`, `Source Lot`, `SOURCE_LOT` 等变体。

