2025-11-30 23:49:35,871 | INFO | root | ================================================================================
2025-11-30 23:49:35,871 | INFO | root | 统一自动化开始
2025-11-30 23:49:35,871 | INFO | root | ================================================================================
2025-11-30 23:49:35,871 | INFO | root | ================================================================================
2025-11-30 23:49:35,871 | INFO | root | 开始执行 PRD LOT 自动化
2025-11-30 23:49:35,871 | INFO | root | ================================================================================
2025-11-30 23:49:35,887 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-11-30 23:49:35,887 | INFO | root | 执行批次 1/1，LOT 数：8
2025-11-30 23:49:35,887 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-11-30 23:49:35,903 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-11-30 23:49:38,262 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-11-30 23:49:38,262 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-11-30 23:49:38,512 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-11-30 23:49:38,741 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-11-30 23:49:39,059 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-11-30 23:49:39,137 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-11-30 23:49:40,418 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-11-30 23:49:40,684 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-11-30 23:49:41,206 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-11-30 23:49:41,206 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-11-30 23:49:41,206 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-11-30 23:49:43,208 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-11-30 23:49:43,208 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-11-30 23:49:43,231 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-11-30 23:49:43,231 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-11-30 23:49:43,231 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-11-30 23:49:43,734 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-11-30 23:49:49,050 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-11-30 23:49:55,340 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-11-30 23:49:56,453 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-11-30 23:49:56,453 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-11-30 23:49:58,454 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-11-30 23:49:58,481 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-11-30 23:49:58,481 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-11-30 23:49:58,481 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-11-30 23:49:58,903 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-11-30 23:50:04,219 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-11-30 23:50:10,559 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-11-30 23:50:11,683 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-11-30 23:50:11,684 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-11-30 23:50:11,700 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-11-30 23:50:13,778 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-11-30 23:50:18,934 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-11-30 23:50:23,994 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-11-30 23:50:29,059 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-11-30 23:50:34,119 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-11-30 23:50:39,177 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-11-30 23:50:43,228 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-11-30 23:50:43,228 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-11-30 23:50:43,228 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-11-30 23:50:43,228 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-11-30 23:52:01,282 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-11-30 23:52:01,282 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-11-30 23:52:01,348 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-11-30 23:52:01,348 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-11-30 23:52:01,364 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-11-30 23:52:01,364 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-11-30 23:52:01,379 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-11-30 23:52:01,379 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-11-30 23:52:01,395 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-11-30 23:52:01,395 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-11-30 23:52:01,395 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-11-30 23:52:01,395 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-11-30 23:52:01,395 | INFO | root | Retest Bin Pareto 生成完成
2025-11-30 23:52:01,395 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-11-30.xlsx
2025-11-30 23:52:02,989 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-11-30.xlsx
2025-11-30 23:52:02,989 | INFO | root | 关闭 SQLPathFinder...
2025-11-30 23:52:03,021 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-11-30 23:52:05,027 | INFO | root | ================================================================================
2025-11-30 23:52:05,027 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-11-30 23:52:05,027 | INFO | root | ================================================================================
2025-11-30 23:52:05,027 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-11-30 23:52:05,037 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-11-30 23:52:05,037 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-11-30 23:52:05,193 | ERROR | root | ❌ 统一自动化失败: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'backend': 'win32', 'visible_only': False}
2025-11-30 23:52:05,209 | ERROR | root | Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 199, in main
    lab_report = run_lab_tp_automation(lab_config_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 135, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 654, in execute
    self._ensure_application()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 59, in _ensure_application
    self._app = Application(backend="win32").connect(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'backend': 'win32', 'visible_only': False}

2025-11-30 23:57:04,689 | INFO | root | ================================================================================
2025-11-30 23:57:04,689 | INFO | root | 统一自动化开始
2025-11-30 23:57:04,689 | INFO | root | ================================================================================
2025-11-30 23:57:04,689 | INFO | root | ================================================================================
2025-11-30 23:57:04,689 | INFO | root | 开始执行 PRD LOT 自动化
2025-11-30 23:57:04,689 | INFO | root | ================================================================================
2025-11-30 23:57:04,705 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-11-30 23:57:04,705 | INFO | root | 执行批次 1/1，LOT 数：8
2025-11-30 23:57:04,705 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-11-30 23:57:04,705 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-11-30 23:57:06,799 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-11-30 23:57:06,814 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 9034) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-11-30 23:57:06,814 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-11-30 23:57:06,814 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-11-30 23:57:06,814 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-11-30 23:57:07,030 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-11-30 23:57:07,336 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-11-30 23:57:07,342 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-11-30 23:57:08,560 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-11-30 23:57:08,565 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-11-30 23:57:09,271 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-11-30 23:57:09,280 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-11-30 23:57:09,280 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-11-30 23:57:11,282 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-11-30 23:57:11,282 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-11-30 23:57:11,303 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-11-30 23:57:11,303 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-11-30 23:57:11,303 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-11-30 23:57:11,724 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-11-30 23:57:17,037 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-11-30 23:57:23,195 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-11-30 23:57:24,326 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-11-30 23:57:24,326 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-11-30 23:57:26,327 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-11-30 23:57:26,354 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-11-30 23:57:26,354 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-11-30 23:57:26,354 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-11-30 23:57:26,784 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-11-30 23:57:32,096 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-11-30 23:57:38,315 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-11-30 23:57:39,513 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-11-30 23:57:39,638 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-11-30 23:57:39,658 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-11-30 23:57:41,681 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-11-30 23:57:46,744 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-11-30 23:57:51,803 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-11-30 23:57:56,861 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-11-30 23:58:01,921 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-11-30 23:58:06,983 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-11-30 23:58:11,035 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-11-30 23:58:11,035 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-11-30 23:58:11,035 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-11-30 23:58:11,035 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-11-30 23:59:29,064 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-11-30 23:59:29,064 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-11-30 23:59:29,128 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-11-30 23:59:29,144 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-11-30 23:59:29,144 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-11-30 23:59:29,160 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-11-30 23:59:29,175 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-11-30 23:59:29,175 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-11-30 23:59:29,191 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-11-30 23:59:29,191 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-11-30 23:59:29,191 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-11-30 23:59:29,207 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-11-30 23:59:29,207 | INFO | root | Retest Bin Pareto 生成完成
2025-11-30 23:59:29,207 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-11-30.xlsx
2025-11-30 23:59:30,910 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-11-30.xlsx
2025-11-30 23:59:30,910 | INFO | root | 关闭 SQLPathFinder...
2025-11-30 23:59:30,936 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-11-30 23:59:32,940 | INFO | root | ================================================================================
2025-11-30 23:59:32,940 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-11-30 23:59:32,940 | INFO | root | ================================================================================
2025-11-30 23:59:32,941 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-11-30 23:59:32,957 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-11-30 23:59:32,957 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-11-30 23:59:33,144 | ERROR | root | ❌ 统一自动化失败: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-11-30 23:59:33,176 | ERROR | root | Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 199, in main
    lab_report = run_lab_tp_automation(lab_config_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 135, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 681, in execute
    self._ensure_application()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 59, in _ensure_application
    self._app = Application(backend="win32").connect(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}

2025-12-01 00:05:03,070 | INFO | root | ================================================================================
2025-12-01 00:05:03,086 | INFO | root | 统一自动化开始
2025-12-01 00:05:03,086 | INFO | root | ================================================================================
2025-12-01 00:05:03,086 | INFO | root | ================================================================================
2025-12-01 00:05:03,086 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:05:03,086 | INFO | root | ================================================================================
2025-12-01 00:05:03,086 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:05:03,086 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:05:03,086 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:05:03,086 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:05:05,163 | INFO | prd_lot_automation.spf_runner | 找到 13 个 SQLPathFinder 窗口
2025-12-01 00:05:05,398 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 9619) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:05:05,398 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:05:05,398 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:05:05,398 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:05:05,604 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:05:05,910 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:05:05,910 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:05:07,124 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:05:07,124 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:05:07,857 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:05:07,867 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:05:07,867 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:05:09,873 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:05:09,873 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:05:09,895 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:05:09,895 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:05:09,895 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:05:10,318 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:05:15,633 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:05:21,820 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:05:22,900 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:05:22,900 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:05:24,902 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:05:24,929 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:05:24,929 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:05:24,929 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:05:25,351 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:05:30,665 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:05:36,852 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:05:37,975 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:05:37,977 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:05:37,977 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:05:39,993 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:05:45,054 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:05:50,112 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:05:55,175 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:06:00,237 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:06:05,298 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:06:09,347 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:06:09,347 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:06:09,347 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:06:09,347 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:07:27,389 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:07:27,389 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:07:27,447 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:07:27,460 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:07:27,460 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:07:27,460 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:07:27,478 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:07:27,478 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:07:27,492 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:07:27,492 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:07:27,492 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:07:27,492 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:07:27,492 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:07:27,508 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:07:29,071 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:07:29,071 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:07:29,087 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:07:31,100 | INFO | root | ================================================================================
2025-12-01 00:07:31,100 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:07:31,100 | INFO | root | ================================================================================
2025-12-01 00:07:31,104 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:07:31,104 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:07:31,104 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:07:31,295 | ERROR | root | ❌ 统一自动化失败: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:07:31,295 | ERROR | root | Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 201, in main
    lab_report = run_lab_tp_automation(lab_config_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 136, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 681, in execute
    self._ensure_application()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 59, in _ensure_application
    self._app = Application(backend="win32").connect(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}

2025-12-01 00:11:39,356 | INFO | root | ================================================================================
2025-12-01 00:11:39,364 | INFO | root | 统一自动化开始
2025-12-01 00:11:39,364 | INFO | root | ================================================================================
2025-12-01 00:11:39,364 | INFO | root | ================================================================================
2025-12-01 00:11:39,364 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:11:39,364 | INFO | root | ================================================================================
2025-12-01 00:11:39,387 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:11:39,387 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:11:39,387 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:11:39,387 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:11:42,918 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:11:42,918 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 1779) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:11:42,918 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:11:42,918 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:11:42,918 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:11:43,128 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:11:43,431 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:11:43,434 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:11:44,680 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:11:44,685 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:11:45,488 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:11:45,488 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:11:45,495 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:11:47,499 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:11:47,499 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:11:47,512 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:11:47,528 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:11:47,528 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:11:47,983 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:11:53,300 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:11:59,529 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:12:00,625 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:12:00,625 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:12:02,627 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:12:02,653 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:12:02,653 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:12:02,653 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:12:03,076 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:12:08,387 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:12:14,558 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:12:15,571 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:12:15,571 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:12:15,590 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:12:17,597 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:12:22,657 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:12:27,761 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:12:32,827 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:12:37,891 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:12:42,953 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:12:47,012 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:12:47,012 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:12:47,012 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:12:47,012 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:14:05,036 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:14:05,036 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:14:05,109 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:14:05,109 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:14:05,109 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:14:05,124 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:14:05,141 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:14:05,156 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:14:05,156 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:14:05,156 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:14:05,156 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:14:05,156 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:14:05,172 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:14:05,172 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:14:07,306 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:14:07,306 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:14:07,326 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:14:09,338 | INFO | root | ================================================================================
2025-12-01 00:14:09,338 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:14:09,338 | INFO | root | ================================================================================
2025-12-01 00:14:09,342 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:14:09,342 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:14:09,342 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:14:09,517 | ERROR | root | ❌ 统一自动化失败: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:14:09,564 | ERROR | root | Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 199, in main
    lab_report = run_lab_tp_automation(lab_config_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 135, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 681, in execute
    self._ensure_application()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 59, in _ensure_application
    self._app = Application(backend="win32").connect(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}

2025-12-01 00:18:22,302 | INFO | root | ================================================================================
2025-12-01 00:18:22,304 | INFO | root | 统一自动化开始
2025-12-01 00:18:22,305 | INFO | root | ================================================================================
2025-12-01 00:18:22,311 | INFO | root | ================================================================================
2025-12-01 00:18:22,311 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:18:22,312 | INFO | root | ================================================================================
2025-12-01 00:18:22,321 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:18:22,321 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:18:22,322 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:18:22,323 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:18:27,329 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: 
2025-12-01 00:18:28,339 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:18:30,735 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:18:30,735 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 63) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:18:30,735 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:18:30,735 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:18:30,751 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:18:30,953 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:18:31,256 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:18:31,256 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:18:32,485 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:18:32,500 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:18:33,189 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:18:33,205 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:18:33,205 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:18:35,219 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:18:35,219 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:18:35,235 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:18:35,235 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:18:35,251 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:18:35,741 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:18:41,047 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:18:47,331 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:18:48,348 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:18:48,348 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:18:50,349 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:18:50,376 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:18:50,376 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:18:50,376 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:18:50,850 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:18:56,160 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:19:02,536 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:19:03,766 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:19:03,831 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:19:03,878 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:19:05,891 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:19:10,983 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:19:16,042 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:19:21,104 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:19:26,198 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:19:31,259 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:19:35,309 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:19:35,309 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:19:35,309 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:19:35,309 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:21:03,347 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:21:03,347 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:21:03,424 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:21:03,424 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:21:03,424 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:21:03,440 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:21:03,440 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:21:03,455 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:21:03,455 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:21:03,471 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:21:03,471 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:21:03,471 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:21:03,471 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:21:03,471 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:21:05,080 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:21:05,096 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:21:05,158 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:21:05,158 | INFO | root | ================================================================================
2025-12-01 00:21:05,158 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 00:21:05,158 | INFO | root | ================================================================================
2025-12-01 00:21:05,174 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:21:07,182 | INFO | root | ================================================================================
2025-12-01 00:21:07,182 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:21:07,182 | INFO | root | ================================================================================
2025-12-01 00:21:07,182 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:21:07,182 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:21:07,193 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:21:07,209 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到 SQLPathFinder 窗口: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:21:08,219 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:21:08,365 | ERROR | root | ❌ 统一自动化失败: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}
2025-12-01 00:21:08,412 | ERROR | root | Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 205, in main
    lab_report = run_lab_tp_automation(lab_config_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 135, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 697, in execute
    self._ensure_application()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 75, in _ensure_application
    self._app = Application(backend="win32").connect(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 997, in connect
    self.process = findwindows.find_element(**kwargs).process_id
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 2 elements that match the criteria {'title_re': 'SQLPathFinder', 'visible_only': True, 'backend': 'win32'}

2025-12-01 00:24:05,535 | INFO | root | ================================================================================
2025-12-01 00:24:05,551 | INFO | root | 统一自动化开始
2025-12-01 00:24:05,551 | INFO | root | ================================================================================
2025-12-01 00:24:05,551 | INFO | root | ================================================================================
2025-12-01 00:24:05,551 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:24:05,551 | INFO | root | ================================================================================
2025-12-01 00:24:05,566 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:24:05,582 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:24:05,582 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:24:05,582 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:24:05,582 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:24:05,582 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:24:05,582 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:24:05,692 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:24:06,703 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:24:08,883 | INFO | prd_lot_automation.spf_runner | 找到 13 个 SQLPathFinder 窗口
2025-12-01 00:24:09,153 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 20526) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:24:09,169 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:24:09,169 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:24:09,176 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:24:09,381 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:24:09,683 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:24:09,683 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:26:43,928 | INFO | root | ================================================================================
2025-12-01 00:26:43,959 | INFO | root | 统一自动化开始
2025-12-01 00:26:43,959 | INFO | root | ================================================================================
2025-12-01 00:26:43,990 | INFO | root | ================================================================================
2025-12-01 00:26:43,990 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:26:43,990 | INFO | root | ================================================================================
2025-12-01 00:26:44,006 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:26:44,006 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:26:44,006 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:26:44,052 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:26:44,052 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:26:44,052 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:26:44,052 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:26:44,178 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:26:45,238 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:26:47,131 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:26:47,353 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 6389) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:26:47,353 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:26:47,353 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:26:47,369 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:26:47,580 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:26:47,885 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:26:47,885 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:26:49,100 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:26:49,105 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:26:50,012 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:26:50,018 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:26:50,019 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:26:52,020 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:26:52,021 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:26:52,044 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:26:52,045 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:26:52,051 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:26:52,473 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:26:57,791 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:27:04,131 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:27:05,231 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:27:05,231 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:27:07,232 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:27:07,256 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:27:07,257 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:27:07,260 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:27:07,682 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:27:12,988 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:27:19,203 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:27:20,710 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:27:20,713 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:27:20,717 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:27:22,718 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:27:27,783 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:27:32,843 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:27:37,902 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:27:42,962 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:27:48,023 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:27:52,085 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:27:52,086 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:27:52,086 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:27:52,086 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:29:10,161 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:29:10,161 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:29:10,234 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:29:10,237 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:29:10,242 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:29:10,250 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:29:10,263 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:29:10,275 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:29:10,289 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:29:10,291 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:29:10,291 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:29:10,295 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:29:10,300 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:29:10,302 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:29:11,853 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:29:11,854 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:29:11,855 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:29:11,855 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:29:11,857 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (6389)
2025-12-01 00:29:12,259 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:29:12,760 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 6389) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:29:13,395 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:29:14,379 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:29:14,457 | INFO | root | ================================================================================
2025-12-01 00:29:14,474 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 00:29:14,476 | INFO | root | ================================================================================
2025-12-01 00:29:14,478 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:29:14,482 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:29:14,483 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:29:14,490 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:29:16,501 | INFO | root | ================================================================================
2025-12-01 00:29:16,513 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:29:16,521 | INFO | root | ================================================================================
2025-12-01 00:29:16,551 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:29:16,566 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:29:16,575 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:29:16,577 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:29:16,593 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:29:16,597 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:29:16,604 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:29:17,606 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:29:19,346 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:29:19,442 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 20700) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:29:19,576 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:29:19,669 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:29:19,807 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:29:20,081 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:29:20,383 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:29:20,383 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:29:21,598 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:29:21,602 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:29:22,719 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:29:22,719 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:29:22,719 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:29:24,721 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:29:24,722 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:29:24,746 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:29:24,746 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:29:24,749 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:29:25,185 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:29:30,503 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:29:36,898 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:29:38,171 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:29:38,174 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:29:40,189 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:29:45,248 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #2...
2025-12-01 00:29:50,308 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #2...
2025-12-01 00:29:55,369 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #2...
2025-12-01 00:30:00,430 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #2...
2025-12-01 00:30:05,478 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #2...
2025-12-01 00:30:09,539 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #2
2025-12-01 00:30:09,541 | INFO | prd_lot_automation.spf_runner | 没有第二个参数弹窗
2025-12-01 00:30:09,541 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:30:09,542 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:30:17,549 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:30:17,594 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:30:17,608 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 00:30:17,611 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 00:30:17,615 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 00:30:17,616 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:30:17,674 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:30:17,693 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:30:17,700 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:30:17,701 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:30:17,701 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (20700)
2025-12-01 00:30:18,169 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:30:18,702 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 20700) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:30:19,410 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:30:19,916 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:30:19,922 | INFO | root | ================================================================================
2025-12-01 00:30:19,922 | INFO | root | 发送统一邮件
2025-12-01 00:30:19,923 | INFO | root | ================================================================================
2025-12-01 00:30:19,940 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:30:20,196 | INFO | prd_lot_automation.mailer | Outlook 邮件已发送
2025-12-01 00:30:20,225 | INFO | root | ================================================================================
2025-12-01 00:30:20,226 | INFO | root | ✅ 统一自动化完成
2025-12-01 00:30:20,234 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:30:20,238 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:30:20,246 | INFO | root | ================================================================================
2025-12-01 00:36:45,676 | INFO | root | ================================================================================
2025-12-01 00:36:45,677 | INFO | root | 统一自动化开始
2025-12-01 00:36:45,678 | INFO | root | ================================================================================
2025-12-01 00:36:45,678 | INFO | root | ================================================================================
2025-12-01 00:36:45,679 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:36:45,680 | INFO | root | ================================================================================
2025-12-01 00:36:45,697 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:36:45,698 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:36:45,700 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:36:45,701 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:36:45,702 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:36:45,702 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:36:45,795 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:36:46,796 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:36:48,460 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:36:48,461 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 12753) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:36:48,461 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:36:48,461 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:36:48,463 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:36:48,667 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:36:48,968 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:36:48,969 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:36:50,240 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:36:50,250 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:36:51,198 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:36:51,255 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:36:51,257 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:36:53,258 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:36:53,258 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:36:53,286 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:36:53,303 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:36:53,308 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:36:53,745 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:36:59,063 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:37:05,268 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:37:06,398 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:37:06,421 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:37:08,430 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:37:13,647 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #2...
2025-12-01 00:37:18,705 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #2...
2025-12-01 00:37:23,772 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #2...
2025-12-01 00:37:28,833 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #2...
2025-12-01 00:37:33,894 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #2...
2025-12-01 00:37:37,954 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #2
2025-12-01 00:37:37,955 | INFO | prd_lot_automation.spf_runner | 没有第二个参数弹窗
2025-12-01 00:37:37,955 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:37:37,955 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:37:45,957 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:37:45,974 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:37:46,012 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 00:37:46,015 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 00:37:46,020 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 00:37:46,021 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:37:46,139 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:37:46,147 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:37:46,148 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:37:46,149 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:37:46,150 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (12753)
2025-12-01 00:37:46,636 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:37:47,148 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 12753) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:37:47,638 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:37:48,181 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:37:48,189 | INFO | root | ================================================================================
2025-12-01 00:37:48,190 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 00:37:48,191 | INFO | root | ================================================================================
2025-12-01 00:37:48,191 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:37:48,192 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:37:48,192 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:37:48,202 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:37:50,204 | INFO | root | ================================================================================
2025-12-01 00:37:50,204 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:37:50,205 | INFO | root | ================================================================================
2025-12-01 00:37:50,220 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:37:50,223 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:37:50,223 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:37:50,226 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:37:50,226 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:37:50,229 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:37:50,229 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:37:50,236 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:37:51,237 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:37:52,964 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:37:53,067 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 7188) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:37:53,118 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:37:53,139 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:37:53,141 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:37:53,379 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:37:53,682 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:37:53,682 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:37:54,897 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:37:54,905 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:37:55,618 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:37:55,618 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:37:55,629 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:37:57,630 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:37:57,630 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:37:57,656 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:37:57,663 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:37:57,666 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:37:58,094 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:38:03,409 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:38:09,634 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:38:10,735 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:38:10,736 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:38:12,737 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:38:12,763 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:38:12,764 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:38:12,766 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:38:13,190 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:38:18,507 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:38:24,671 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:38:25,821 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:38:25,824 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:38:25,850 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:38:27,857 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:38:32,922 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:38:37,984 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:38:43,045 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:38:48,108 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:38:53,169 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:38:57,228 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:38:57,229 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:38:57,229 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:38:57,229 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:40:17,254 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:40:17,254 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:40:17,309 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:40:17,313 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:40:17,318 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:40:17,324 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:40:17,336 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:40:17,346 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:40:17,353 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:40:17,354 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:40:17,355 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:40:17,358 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:40:17,362 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:40:17,364 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:40:18,916 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:40:18,917 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:40:18,918 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:40:18,918 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:40:18,920 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (7188)
2025-12-01 00:40:19,336 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:40:19,851 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 7188) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:40:20,276 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:40:20,893 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:40:20,920 | INFO | root | ================================================================================
2025-12-01 00:40:20,922 | INFO | root | 发送统一邮件
2025-12-01 00:40:20,922 | INFO | root | ================================================================================
2025-12-01 00:40:20,943 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:40:21,234 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 00:40:21,273 | INFO | root | ================================================================================
2025-12-01 00:40:21,287 | INFO | root | ✅ 统一自动化完成
2025-12-01 00:40:21,287 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:40:21,287 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:40:21,287 | INFO | root | ================================================================================
2025-12-01 00:46:55,459 | INFO | root | ================================================================================
2025-12-01 00:46:55,460 | INFO | root | 统一自动化开始
2025-12-01 00:46:55,460 | INFO | root | ================================================================================
2025-12-01 00:46:55,461 | INFO | root | ================================================================================
2025-12-01 00:46:55,462 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:46:55,465 | INFO | root | ================================================================================
2025-12-01 00:46:55,482 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:46:55,482 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:46:55,483 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:46:55,484 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:46:55,486 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:46:55,486 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:46:55,583 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:46:56,585 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:46:58,227 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:46:58,234 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 19438) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:46:58,234 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:46:58,235 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:46:58,237 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:46:58,439 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:46:58,742 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:46:58,742 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:46:59,958 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:46:59,968 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:47:01,075 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:47:01,075 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:47:01,075 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:47:03,076 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:47:03,076 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:47:03,103 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:47:03,115 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:47:03,122 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:47:03,581 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:47:08,898 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:47:15,157 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:47:16,290 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:47:16,311 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:47:18,323 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:47:23,400 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #2...
2025-12-01 00:47:28,460 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #2...
2025-12-01 00:47:33,521 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #2...
2025-12-01 00:47:38,582 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #2...
2025-12-01 00:47:43,644 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #2...
2025-12-01 00:47:47,703 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #2
2025-12-01 00:47:47,703 | INFO | prd_lot_automation.spf_runner | 没有第二个参数弹窗
2025-12-01 00:47:47,703 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:47:47,704 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:47:55,707 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:47:55,711 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:47:55,724 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 00:47:55,731 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 00:47:55,736 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 00:47:55,736 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:47:55,837 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:47:55,843 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:47:55,845 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:47:55,847 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:47:55,847 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (19438)
2025-12-01 00:47:56,249 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:47:56,762 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 19438) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:47:57,273 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:47:57,963 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:47:57,983 | INFO | root | ================================================================================
2025-12-01 00:47:57,988 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 00:47:57,988 | INFO | root | ================================================================================
2025-12-01 00:47:57,989 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:47:57,989 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:47:57,990 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:47:57,997 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:47:59,998 | INFO | root | ================================================================================
2025-12-01 00:48:00,044 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:48:00,055 | INFO | root | ================================================================================
2025-12-01 00:48:00,109 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:48:00,113 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:48:00,123 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:48:00,134 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:48:00,146 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:48:00,152 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:48:00,153 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:48:00,167 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:48:01,171 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:48:03,105 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:48:03,106 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 12599) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:48:03,106 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:48:03,107 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:48:03,108 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:48:03,311 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:48:03,613 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:48:03,614 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:48:04,829 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:48:04,834 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:48:05,553 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:48:05,555 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:48:05,555 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:48:07,556 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:48:07,556 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:48:07,579 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:48:07,580 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:48:07,582 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:48:08,002 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:48:13,320 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:48:19,558 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:48:20,624 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:48:20,625 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:48:22,625 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:48:22,650 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:48:22,650 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:48:22,653 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:48:23,065 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:48:28,382 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:48:34,607 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:48:35,619 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:48:35,644 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:48:35,653 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:48:37,664 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:48:42,732 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:48:47,791 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:48:52,850 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:48:57,909 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:49:02,972 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:49:07,030 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:49:07,031 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:49:07,031 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:49:07,031 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:50:25,053 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:50:25,053 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:50:25,110 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:50:25,113 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:50:25,119 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:50:25,124 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:50:25,139 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:50:25,144 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:50:25,148 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:50:25,149 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:50:25,150 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:50:25,152 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:50:25,158 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:50:25,170 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:50:26,729 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:50:26,730 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:50:26,730 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:50:26,731 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:50:26,731 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (12599)
2025-12-01 00:50:27,145 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:50:27,659 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 12599) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:50:28,142 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:50:28,655 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:50:28,662 | INFO | root | ================================================================================
2025-12-01 00:50:28,663 | INFO | root | 发送统一邮件
2025-12-01 00:50:28,663 | INFO | root | ================================================================================
2025-12-01 00:50:28,672 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:50:28,677 | ERROR | root | ❌ 统一自动化失败: 'Teste Good'
2025-12-01 00:50:28,684 | ERROR | root | Traceback (most recent call last):
  File "C:\ProgramData\miniforge3\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Teste Good'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 364, in main
    send_unified_email(prd_config, prd_report, lab_report, lab_df, len(lots))
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 170, in send_unified_email
    lab_html_table = generate_lab_tp_html_table(lab_df)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 297, in generate_lab_tp_html_table
    value = row[col]
            ~~~^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Teste Good'

2025-12-01 00:53:25,793 | INFO | root | ================================================================================
2025-12-01 00:53:25,794 | INFO | root | 统一自动化开始
2025-12-01 00:53:25,794 | INFO | root | ================================================================================
2025-12-01 00:53:25,795 | INFO | root | ================================================================================
2025-12-01 00:53:25,796 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 00:53:25,797 | INFO | root | ================================================================================
2025-12-01 00:53:25,813 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:53:25,814 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:53:25,818 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:53:25,822 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:53:25,824 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:53:25,826 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:53:25,957 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:53:26,967 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 00:53:30,010 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:53:30,018 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 11692) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:53:30,018 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:53:30,019 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:53:30,020 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:53:30,223 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:53:30,525 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:53:30,525 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:53:31,741 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:53:31,749 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:53:32,865 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:53:32,875 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:53:32,876 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:53:34,878 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:53:34,879 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:53:34,977 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:53:34,996 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:53:35,014 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:53:35,449 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:53:40,762 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:53:46,992 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:53:48,161 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:53:48,180 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:53:50,208 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:53:55,265 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #2...
2025-12-01 00:54:00,320 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #2...
2025-12-01 00:54:05,384 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #2...
2025-12-01 00:54:10,487 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #2...
2025-12-01 00:54:15,552 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #2...
2025-12-01 00:54:19,614 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #2
2025-12-01 00:54:19,614 | INFO | prd_lot_automation.spf_runner | 没有第二个参数弹窗
2025-12-01 00:54:19,615 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:54:19,615 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:54:27,618 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:54:27,622 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 00:54:27,639 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 00:54:27,650 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 00:54:27,657 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 00:54:27,657 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:54:27,733 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:54:27,761 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:54:27,784 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:54:27,786 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:54:27,786 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (11692)
2025-12-01 00:54:28,210 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:54:28,713 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 11692) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 00:54:29,159 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:54:29,846 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:54:29,846 | INFO | root | ================================================================================
2025-12-01 00:54:29,846 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 00:54:29,846 | INFO | root | ================================================================================
2025-12-01 00:54:29,846 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:54:29,849 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:54:29,849 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:54:29,862 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:54:31,864 | INFO | root | ================================================================================
2025-12-01 00:54:31,881 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 00:54:31,890 | INFO | root | ================================================================================
2025-12-01 00:54:31,912 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:54:31,924 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 00:54:31,925 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 00:54:31,925 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 00:54:31,926 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:54:31,926 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 00:54:31,927 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 00:54:31,933 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 00:54:32,935 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 00:54:35,182 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 00:54:35,191 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 15335) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:54:35,191 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 00:54:35,191 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 00:54:35,199 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 00:54:35,401 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 00:54:35,708 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 00:54:35,709 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 00:54:36,927 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 00:54:36,933 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 00:54:37,654 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 00:54:37,655 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 00:54:37,656 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 00:54:39,657 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 00:54:39,657 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 00:54:39,682 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 00:54:39,683 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:54:39,686 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:54:40,143 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:54:45,460 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 00:54:51,689 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 00:54:52,728 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 00:54:52,728 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 00:54:54,729 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 00:54:54,768 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 00:54:54,769 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 00:54:54,771 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 00:54:55,205 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 00:55:00,510 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 00:55:06,823 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 00:55:07,951 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 00:55:07,988 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 00:55:07,997 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 00:55:10,009 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 00:55:15,068 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 00:55:20,133 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 00:55:25,195 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 00:55:30,258 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 00:55:35,322 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 00:55:39,384 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 00:55:39,387 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 00:55:39,390 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 00:55:39,391 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 00:56:59,480 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:56:59,489 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 00:56:59,567 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 00:56:59,575 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 00:56:59,583 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 00:56:59,599 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:56:59,619 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:56:59,627 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 00:56:59,630 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 00:56:59,636 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 00:56:59,637 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 00:56:59,642 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 00:56:59,647 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 00:56:59,651 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:57:01,349 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:57:01,352 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 00:57:01,352 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 00:57:01,353 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 00:57:01,355 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (15335)
2025-12-01 00:57:01,769 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:57:02,270 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 15335) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 00:57:02,676 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 00:57:03,338 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 00:57:03,348 | INFO | root | ================================================================================
2025-12-01 00:57:03,360 | INFO | root | 发送统一邮件
2025-12-01 00:57:03,380 | INFO | root | ================================================================================
2025-12-01 00:57:03,494 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 00:57:03,814 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 00:57:03,844 | INFO | root | ================================================================================
2025-12-01 00:57:03,847 | INFO | root | ✅ 统一自动化完成
2025-12-01 00:57:03,847 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 00:57:03,847 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 00:57:03,847 | INFO | root | ================================================================================
2025-12-01 01:00:07,385 | INFO | root | ================================================================================
2025-12-01 01:00:07,386 | INFO | root | 统一自动化开始
2025-12-01 01:00:07,386 | INFO | root | ================================================================================
2025-12-01 01:00:07,387 | INFO | root | ================================================================================
2025-12-01 01:00:07,388 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 01:00:07,391 | INFO | root | ================================================================================
2025-12-01 01:00:07,406 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 01:00:07,407 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 01:00:07,407 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 01:00:07,407 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:00:07,408 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 01:00:07,409 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 01:00:07,502 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 01:00:08,503 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 01:00:10,434 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 01:00:10,439 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 13703) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 01:00:10,440 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 01:00:10,440 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 01:00:10,442 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 01:00:10,646 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 01:00:10,955 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 01:00:11,079 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 01:00:12,429 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 01:00:12,431 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 01:00:13,567 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 01:00:13,596 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 01:00:13,625 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 01:00:15,638 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 01:00:15,638 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 01:00:15,693 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 01:00:15,693 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 01:00:15,700 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 01:00:16,139 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 01:00:21,455 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 01:00:27,695 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 01:00:28,787 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 01:00:28,791 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 01:00:30,824 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 01:00:35,882 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #2...
2025-12-01 01:00:40,941 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #2...
2025-12-01 01:00:46,001 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #2...
2025-12-01 01:00:51,059 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #2...
2025-12-01 01:00:56,167 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #2...
2025-12-01 01:01:00,227 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #2
2025-12-01 01:01:00,228 | INFO | prd_lot_automation.spf_runner | 没有第二个参数弹窗
2025-12-01 01:01:00,228 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 01:01:00,229 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 01:01:08,231 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 01:01:08,234 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 01:01:08,252 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 01:01:08,267 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 01:01:08,275 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 01:01:08,275 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 01:01:08,330 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 01:01:08,336 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 01:01:08,337 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:01:08,338 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 01:01:08,338 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (13703)
2025-12-01 01:01:08,741 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:01:09,242 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 13703) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 01:01:10,053 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:01:10,565 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 01:01:10,647 | INFO | root | ================================================================================
2025-12-01 01:01:10,655 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 01:01:10,661 | INFO | root | ================================================================================
2025-12-01 01:01:10,661 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:01:10,664 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 01:01:10,681 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 01:01:10,733 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 01:01:12,750 | INFO | root | ================================================================================
2025-12-01 01:01:12,751 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 01:01:12,751 | INFO | root | ================================================================================
2025-12-01 01:01:12,768 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 01:01:12,774 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 01:01:12,775 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 01:01:12,775 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 01:01:12,776 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:01:12,779 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 01:01:12,779 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 01:01:12,786 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 01:01:13,787 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 01:01:15,538 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 01:01:15,660 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 1353) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 01:01:15,661 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 01:01:15,661 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 01:01:15,663 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 01:01:15,865 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 01:01:16,166 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 01:01:16,169 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 01:01:17,395 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 01:01:17,397 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 01:01:18,120 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 01:01:18,120 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 01:01:18,136 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 01:01:20,155 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 01:01:20,155 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 01:01:20,186 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 01:01:20,186 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 01:01:20,188 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 01:01:20,607 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 01:01:25,911 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 01:01:32,230 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 01:01:33,265 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交
2025-12-01 01:01:33,266 | INFO | prd_lot_automation.spf_runner | 检查是否有第二个参数弹窗...
2025-12-01 01:01:35,267 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 01:01:35,298 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 01:01:35,306 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 01:01:35,316 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 01:01:35,791 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 01:01:41,103 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 01:01:47,360 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 01:01:48,411 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交
2025-12-01 01:01:48,413 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 01:01:48,445 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 01:01:50,457 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 01:01:55,516 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 01:02:00,578 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 01:02:05,645 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 01:02:10,703 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 01:02:15,902 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 01:02:19,960 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 01:02:19,963 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 01:02:20,000 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 01:02:20,006 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 01:03:38,064 | INFO | prd_lot_automation.spf_runner | 检测到 CSV 文件稳定：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 01:03:38,064 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 01:03:38,147 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 01:03:38,167 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 01:03:38,171 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 01:03:38,188 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 01:03:38,203 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 01:03:38,215 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 01:03:38,227 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 01:03:38,244 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 01:03:38,254 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 01:03:38,259 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 01:03:38,273 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 01:03:38,275 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 01:03:40,012 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 01:03:40,015 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 01:03:40,018 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:03:40,024 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 01:03:40,032 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (1353)
2025-12-01 01:03:40,534 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:03:41,035 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 1353) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 01:03:41,694 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:03:42,215 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 01:03:42,248 | INFO | root | ================================================================================
2025-12-01 01:03:42,254 | INFO | root | 发送统一邮件
2025-12-01 01:03:42,254 | INFO | root | ================================================================================
2025-12-01 01:03:42,280 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 01:03:42,629 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 01:03:42,694 | INFO | root | ================================================================================
2025-12-01 01:03:42,708 | INFO | root | ✅ 统一自动化完成
2025-12-01 01:03:42,712 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 01:03:42,713 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 01:03:42,713 | INFO | root | ================================================================================
2025-12-01 01:55:14,282 | INFO | root | ================================================================================
2025-12-01 01:55:14,284 | INFO | root | 统一自动化开始
2025-12-01 01:55:14,290 | INFO | root | ================================================================================
2025-12-01 01:55:14,295 | INFO | root | ================================================================================
2025-12-01 01:55:14,296 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 01:55:14,297 | INFO | root | ================================================================================
2025-12-01 01:55:14,305 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 01:55:14,306 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 01:55:14,306 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 01:55:14,307 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:55:14,309 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 01:55:14,310 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 01:55:14,402 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 01:55:15,403 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 01:55:19,141 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 01:55:19,144 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 6084) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 01:55:19,147 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 01:55:19,147 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 01:55:19,149 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 01:55:19,356 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 01:55:19,658 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 01:55:19,658 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 01:55:20,874 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 01:55:20,880 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 01:55:21,843 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 01:55:21,864 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 01:55:21,867 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 01:55:23,870 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 01:55:23,871 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 01:55:23,904 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 01:55:23,920 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 01:55:23,930 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 01:55:24,397 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 01:55:29,720 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 01:55:35,903 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 01:55:36,613 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 01:55:36,636 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 01:55:36,653 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (6084)
2025-12-01 01:55:36,705 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-01 01:55:36,716 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 01:55:36,743 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 01:55:36,775 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:55:36,795 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 01:55:36,804 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 01:55:36,804 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 01:55:36,805 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:55:36,805 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,743 字节，已等待 0 秒)
2025-12-01 01:55:38,806 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-01 01:55:42,810 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-01 01:55:46,813 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:55:46,813 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 01:55:46,814 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,743 字节
2025-12-01 01:55:46,814 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-01 01:55:46,815 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:55:46,818 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 01:55:46,833 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 01:55:46,836 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 01:55:46,844 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 01:55:46,844 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 01:55:46,918 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 01:55:46,929 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 01:55:46,930 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:55:46,930 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 01:55:46,931 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (6084)
2025-12-01 01:55:47,334 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:55:47,835 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 6084) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 01:55:48,322 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:55:48,963 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 01:55:48,964 | INFO | root | ================================================================================
2025-12-01 01:55:48,965 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 01:55:48,973 | INFO | root | ================================================================================
2025-12-01 01:55:48,982 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:55:48,982 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 01:55:48,982 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 01:55:48,990 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 01:55:50,991 | INFO | root | ================================================================================
2025-12-01 01:55:50,992 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 01:55:50,992 | INFO | root | ================================================================================
2025-12-01 01:55:51,009 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 01:55:51,015 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 01:55:51,016 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 01:55:51,017 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 01:55:51,017 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:55:51,017 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 01:55:51,019 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 01:55:51,026 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 01:55:52,027 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 01:55:53,820 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 01:55:53,924 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 11677) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 01:55:53,935 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 01:55:53,936 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 01:55:53,937 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 01:55:54,160 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 01:55:54,464 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 01:55:54,465 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 01:55:55,679 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 01:55:55,685 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 01:55:56,412 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 01:55:56,414 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 01:55:56,414 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 01:55:58,415 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 01:55:58,417 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 01:55:58,444 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 01:55:58,446 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 01:55:58,449 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 01:55:58,910 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 01:56:04,213 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 01:56:10,403 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 01:56:11,001 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 01:56:11,001 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 01:56:21,194 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-01 01:56:23,195 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 01:56:23,223 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 01:56:23,230 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 01:56:23,234 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 01:56:23,668 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 01:56:28,969 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 01:56:35,331 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 01:56:35,881 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 01:56:35,916 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 01:56:35,939 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 01:56:37,950 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 01:56:43,014 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 01:56:48,070 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 01:56:53,132 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 01:56:58,195 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 01:57:03,257 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 01:57:07,316 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 01:57:07,316 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 01:57:07,317 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 01:57:07,317 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 01:57:07,317 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:57:07,317 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 01:57:07,317 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 01:57:07,318 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 01:57:07,318 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:57:15,322 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-01 01:57:25,325 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-01 01:57:35,329 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-01 01:57:45,331 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-01 01:57:55,334 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-01 01:58:05,337 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-01 01:58:15,345 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-01 01:58:17,346 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 2,329,444 字节，已等待 70 秒)
2025-12-01 01:58:21,351 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-01 01:58:25,353 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:58:25,353 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 01:58:25,354 | INFO | prd_lot_automation.spf_runner |    文件大小: 2,329,444 字节
2025-12-01 01:58:25,354 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-01 01:58:25,354 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 01:58:25,354 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 01:58:25,412 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 01:58:25,414 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 01:58:25,416 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 01:58:25,424 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 01:58:25,437 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 01:58:25,446 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 01:58:25,450 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 01:58:25,453 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 01:58:25,453 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 01:58:25,457 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 01:58:25,462 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 01:58:25,463 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 01:58:27,093 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 01:58:27,104 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 01:58:27,107 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 01:58:27,109 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 01:58:27,109 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (11677)
2025-12-01 01:58:27,512 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:58:28,014 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 11677) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 01:58:28,439 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 01:58:29,092 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 01:58:29,105 | INFO | root | ================================================================================
2025-12-01 01:58:29,117 | INFO | root | 发送统一邮件
2025-12-01 01:58:29,139 | INFO | root | ================================================================================
2025-12-01 01:58:29,155 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 01:58:29,354 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 01:58:29,386 | INFO | root | ================================================================================
2025-12-01 01:58:29,396 | INFO | root | ✅ 统一自动化完成
2025-12-01 01:58:29,397 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 01:58:29,399 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 01:58:29,400 | INFO | root | ================================================================================
2025-12-01 02:04:17,870 | INFO | root | ================================================================================
2025-12-01 02:04:17,871 | INFO | root | 统一自动化开始
2025-12-01 02:04:17,872 | INFO | root | ================================================================================
2025-12-01 02:04:17,873 | INFO | root | ================================================================================
2025-12-01 02:04:17,873 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 02:04:17,874 | INFO | root | ================================================================================
2025-12-01 02:04:17,886 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 02:04:17,891 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 02:04:17,892 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 02:04:17,892 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 02:04:17,894 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 02:04:17,895 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 02:04:17,987 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 02:04:18,988 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 02:04:21,897 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 02:04:21,900 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 7978) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 02:04:21,903 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 02:04:21,903 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 02:04:21,905 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 02:04:22,108 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 02:04:22,409 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 02:04:22,410 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 02:04:23,705 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 02:04:23,762 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 02:04:24,871 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 02:04:24,871 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 02:04:24,872 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 02:04:26,873 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 02:04:26,873 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 02:04:26,897 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 02:04:26,898 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 02:04:26,903 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 02:04:27,338 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 02:04:32,646 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 02:04:38,799 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 02:04:39,445 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 02:04:39,450 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 02:04:39,473 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (7978)
2025-12-01 02:04:39,498 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-01 02:04:39,502 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 02:04:39,503 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 02:04:39,503 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:04:39,503 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 02:04:39,503 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 02:04:39,503 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 02:04:39,504 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:04:39,504 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,743 字节，已等待 0 秒)
2025-12-01 02:04:41,505 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-01 02:04:45,509 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-01 02:04:49,515 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:04:49,515 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 02:04:49,515 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,743 字节
2025-12-01 02:04:49,515 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-01 02:04:49,515 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:04:49,518 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 02:04:49,532 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-01 02:04:49,533 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 02:04:49,540 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-01 02:04:49,545 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 02:04:49,614 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 02:04:49,618 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 02:04:49,619 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 02:04:49,620 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 02:04:49,620 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (7978)
2025-12-01 02:04:50,137 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 02:04:50,650 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 7978) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 02:04:51,064 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 02:04:51,638 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 02:04:51,645 | INFO | root | ================================================================================
2025-12-01 02:04:51,645 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 02:04:51,645 | INFO | root | ================================================================================
2025-12-01 02:04:51,645 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 02:04:51,646 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 02:04:51,646 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 02:04:51,654 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 02:04:53,671 | INFO | root | ================================================================================
2025-12-01 02:04:53,672 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 02:04:53,672 | INFO | root | ================================================================================
2025-12-01 02:04:53,688 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 02:04:53,699 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-01 02:04:53,700 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 02:04:53,700 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 02:04:53,700 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 02:04:53,701 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 02:04:53,701 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 02:04:53,710 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 02:04:54,711 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 02:04:56,584 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 02:04:56,592 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 31309) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 02:04:56,593 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 02:04:56,593 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 02:04:56,594 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 02:04:56,800 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 02:04:57,107 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 02:04:57,108 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 02:04:58,323 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 02:04:58,329 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 02:04:59,056 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 02:04:59,056 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 02:04:59,056 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 02:05:01,057 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 02:05:01,057 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 02:05:01,080 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 02:05:01,081 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 02:05:01,084 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 02:05:01,510 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 02:05:06,825 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 02:05:13,021 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 02:05:13,629 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 02:05:13,630 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 02:05:23,744 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-01 02:05:25,745 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 02:05:25,767 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 02:05:25,768 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 02:05:25,771 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 02:05:26,197 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 02:05:31,513 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 02:05:37,730 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 02:05:38,370 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 02:05:38,387 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 02:05:38,397 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 02:05:40,405 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 02:05:45,470 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 02:05:50,533 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 02:05:55,595 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 02:06:00,658 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 02:06:05,721 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 02:06:09,781 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 02:06:09,782 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 02:06:09,782 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-01 02:06:09,782 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 02:06:09,782 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:06:09,782 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 02:06:09,783 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 02:06:09,783 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 02:06:09,783 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:06:17,786 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-01 02:06:27,791 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-01 02:06:37,794 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-01 02:06:47,796 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-01 02:06:57,800 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-01 02:07:07,803 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-01 02:07:17,806 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-01 02:07:21,859 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 2,329,444 字节，已等待 72 秒)
2025-12-01 02:07:23,864 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 1/4)
2025-12-01 02:07:27,866 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 78 秒，稳定检查: 3/4)
2025-12-01 02:07:29,867 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:07:29,867 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 02:07:29,868 | INFO | prd_lot_automation.spf_runner |    文件大小: 2,329,444 字节
2025-12-01 02:07:29,868 | INFO | prd_lot_automation.spf_runner |    等待时间: 80 秒
2025-12-01 02:07:29,868 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 02:07:29,868 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 02:07:29,923 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 7752 行过滤到 5300 行
2025-12-01 02:07:29,931 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5300 行过滤到 1325 行
2025-12-01 02:07:29,935 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 1325 行
2025-12-01 02:07:29,942 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 02:07:29,955 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 02:07:29,962 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 02:07:29,967 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 7752 行过滤到 2452 行
2025-12-01 02:07:29,968 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2452 行过滤到 613 行
2025-12-01 02:07:29,969 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 7752 行过滤到 613 行
2025-12-01 02:07:29,974 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 02:07:29,984 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 02:07:29,989 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 02:07:31,531 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 02:07:31,535 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 02:07:31,541 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 02:07:31,542 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 02:07:31,542 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (31309)
2025-12-01 02:07:31,944 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 02:07:32,445 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 31309) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 02:07:33,011 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 02:07:33,532 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 02:07:33,540 | INFO | root | ================================================================================
2025-12-01 02:07:33,544 | INFO | root | 发送统一邮件
2025-12-01 02:07:33,545 | INFO | root | ================================================================================
2025-12-01 02:07:33,558 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 02:07:33,734 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 02:07:33,751 | INFO | root | ================================================================================
2025-12-01 02:07:33,754 | INFO | root | ✅ 统一自动化完成
2025-12-01 02:07:33,754 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 02:07:33,777 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 02:07:33,778 | INFO | root | ================================================================================
2025-12-01 02:11:37,630 | INFO | root | ================================================================================
2025-12-01 02:11:37,632 | INFO | root | 统一自动化开始
2025-12-01 02:11:37,632 | INFO | root | ================================================================================
2025-12-01 02:11:37,632 | INFO | root | ================================================================================
2025-12-01 02:11:37,633 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 02:11:37,648 | INFO | root | ================================================================================
2025-12-01 02:11:37,657 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 02:11:37,658 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-01 02:11:37,658 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 02:11:37,659 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 02:11:37,661 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 02:11:37,662 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 02:11:37,752 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 02:11:38,753 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 02:11:41,835 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 02:11:41,840 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 23515) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 02:11:41,840 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 02:11:41,841 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 02:11:41,843 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 02:11:42,045 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 02:11:42,347 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 02:11:42,348 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 02:11:44,185 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 02:11:44,476 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 02:11:45,566 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 02:11:45,866 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 02:11:46,074 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 02:11:48,084 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 02:11:48,084 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 02:11:48,119 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 02:11:48,119 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 02:11:48,125 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-01 02:11:49,198 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 02:11:54,500 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 02:12:05,506 | WARNING | prd_lot_automation.spf_runner | 通过 auto_id 点击 OK 失败: {'title_re': '.*Prompt.*Values.*', 'backend': 'win32', 'enabled_only': False, 'visible_only': False, 'process': 8992}
2025-12-01 02:12:10,511 | WARNING | prd_lot_automation.spf_runner | 点击 OK 按钮失败: {'title_re': '.*Prompt.*Values.*', 'backend': 'win32', 'enabled_only': False, 'visible_only': False, 'process': 8992}, 尝试 Enter 键
2025-12-01 02:12:15,548 | ERROR | root | ❌ 统一自动化失败: {'title_re': '.*Prompt.*Values.*', 'backend': 'win32', 'enabled_only': False, 'visible_only': False, 'process': 8992}
2025-12-01 02:12:15,870 | ERROR | root | Traceback (most recent call last):
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
           ^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 394, in main
    lab_report, lab_df = run_lab_tp_automation(lab_config_path)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 135, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 739, in execute
    self._enter_lots(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 692, in _enter_lots
    if not self._process_single_popup(lots, popup_index=1):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 648, in _process_single_popup
    dialog.type_keys("{ENTER}")
    ^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 396, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\application.py", line 203, in __get_ctrl
    dialog = self.backend.generic_wrapper_class(findwindows.find_element(**criteria[0]))
                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title_re': '.*Prompt.*Values.*', 'backend': 'win32', 'enabled_only': False, 'visible_only': False, 'process': 8992}

2025-12-01 21:53:41,694 | INFO | root | ================================================================================
2025-12-01 21:53:41,695 | INFO | root | 统一自动化开始
2025-12-01 21:53:41,695 | INFO | root | ================================================================================
2025-12-01 21:53:41,696 | INFO | root | ================================================================================
2025-12-01 21:53:41,697 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 21:53:41,699 | INFO | root | ================================================================================
2025-12-01 21:53:41,720 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 21:53:41,722 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-01 21:53:41,722 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 21:53:41,723 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 21:53:41,724 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 21:53:41,724 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 21:53:41,818 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 21:53:42,820 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 21:53:44,858 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 21:53:44,863 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 12561) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 21:53:44,866 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 21:53:44,866 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 21:53:44,869 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 21:53:45,078 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 21:53:45,381 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 21:53:45,382 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 21:53:46,597 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 21:53:46,602 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 21:53:47,569 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 21:53:47,576 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 21:53:47,576 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 21:53:49,578 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 21:53:49,578 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 21:53:49,608 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 21:53:49,609 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 21:53:49,615 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 21:53:50,027 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 21:53:55,328 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 21:54:01,586 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 21:54:02,264 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 21:54:02,283 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 21:54:02,299 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (12561)
2025-12-01 21:54:02,312 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-01 21:54:02,314 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-01 21:54:02,317 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 21:54:02,317 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 21:54:02,318 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 21:54:02,318 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 21:54:02,318 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 21:54:02,318 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 21:54:02,318 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,743 字节，已等待 0 秒)
2025-12-01 21:54:04,320 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-01 21:54:08,324 | INFO | prd_lot_automation.spf_runner | 📝 文件正在写入中... (大小: 1,743 → 1,142 字节，已等待 6 秒)
2025-12-01 21:54:12,330 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 10 秒，稳定检查: 2/4)
2025-12-01 21:54:16,332 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 21:54:16,332 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 21:54:16,332 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,142 字节
2025-12-01 21:54:16,333 | INFO | prd_lot_automation.spf_runner |    等待时间: 14 秒
2025-12-01 21:54:16,333 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 21:54:16,336 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 21:54:16,353 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (10, 13)
2025-12-01 21:54:16,353 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 21:54:16,358 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (10, 12)
2025-12-01 21:54:16,358 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 21:54:16,422 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 21:54:16,422 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 21:54:16,425 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 21:54:16,437 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 21:54:16,438 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (12561)
2025-12-01 21:54:16,841 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 21:54:17,347 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 12561) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 21:54:17,827 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 21:54:18,344 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 21:54:18,348 | INFO | root | ================================================================================
2025-12-01 21:54:18,349 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 21:54:18,349 | INFO | root | ================================================================================
2025-12-01 21:54:18,349 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 21:54:18,351 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 21:54:18,352 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 21:54:18,359 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 21:54:20,364 | INFO | root | ================================================================================
2025-12-01 21:54:20,381 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 21:54:20,390 | INFO | root | ================================================================================
2025-12-01 21:54:20,430 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 21:54:20,442 | INFO | root | 执行批次 1/1，LOT 数：7
2025-12-01 21:54:20,446 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-01 21:54:20,451 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 21:54:20,453 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 21:54:20,492 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 21:54:20,494 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 21:54:20,509 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 21:54:21,511 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 21:54:23,143 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 21:54:23,150 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 21226) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 21:54:23,152 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 21:54:23,152 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 21:54:23,162 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 21:54:23,366 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 21:54:23,367 | WARNING | prd_lot_automation.spf_runner | 设置窗口焦点失败: There is no active desktop required for moving mouse cursor!

2025-12-01 21:54:24,270 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 21:54:25,270 | WARNING | prd_lot_automation.spf_runner | type_keys 发送 F8 失败: There is no active desktop required for moving mouse cursor!
，尝试 pyautogui
2025-12-01 21:54:25,271 | WARNING | prd_lot_automation.spf_runner | F8 快捷键失败，尝试其他方法：F8 发送失败: type_keys=There is no active desktop required for moving mouse cursor!
, pyautogui=PyAutoGUI fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set pyautogui.FAILSAFE to False. DISABLING FAIL-SAFE IS NOT RECOMMENDED.
2025-12-01 21:54:25,271 | INFO | prd_lot_automation.spf_runner | 尝试通过图像识别找到 Run 按钮...
2025-12-01 21:54:28,273 | WARNING | prd_lot_automation.spf_runner | 图像识别失败，尝试通过控件查找...
2025-12-01 21:54:28,273 | INFO | prd_lot_automation.spf_runner | 尝试查找工具栏中的 Run 按钮...
2025-12-01 21:54:28,291 | ERROR | prd_lot_automation.spf_runner | 控件查找也失败：无法通过控件找到 Run 按钮
2025-12-01 21:54:28,291 | ERROR | root | ❌ 统一自动化失败: 无法找到 Run 按钮。请检查：
1. SQLPathFinder 窗口是否在前台
2. Run 按钮是否可见
3. 截图 run_button.png 是否正确
4. 或者在 config.yaml 中配置 run_button_automation_id
2025-12-01 21:54:28,294 | ERROR | root | Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 833, in main
    prd_report = run_prd_lot_automation(prd_config_path)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\unified_automation.py", line 56, in run_prd_lot_automation
    runner.execute(batch)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 738, in execute
    self._click_run_button()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 277, in _click_run_button
    self._click_by_image()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\prd_lot_automation\spf_runner.py", line 317, in _click_by_image
    raise TimeoutError(
TimeoutError: 无法找到 Run 按钮。请检查：
1. SQLPathFinder 窗口是否在前台
2. Run 按钮是否可见
3. 截图 run_button.png 是否正确
4. 或者在 config.yaml 中配置 run_button_automation_id

2025-12-01 23:00:11,054 | INFO | root | ================================================================================
2025-12-01 23:00:11,055 | INFO | root | 统一自动化开始
2025-12-01 23:00:11,055 | INFO | root | ================================================================================
2025-12-01 23:00:11,062 | INFO | root | ================================================================================
2025-12-01 23:00:11,069 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 23:00:11,069 | INFO | root | ================================================================================
2025-12-01 23:00:11,081 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 23:00:11,082 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-01 23:00:11,083 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 23:00:11,084 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:00:11,085 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 23:00:11,085 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 23:00:11,220 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 23:00:12,240 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 23:00:13,897 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 23:00:13,901 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 28946) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 23:00:13,904 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 23:00:13,904 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 23:00:13,907 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 23:00:14,110 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 23:00:14,413 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 23:00:14,414 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 23:00:15,628 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 23:00:15,635 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 23:00:16,743 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 23:00:16,750 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 23:00:16,750 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 23:00:18,752 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 23:00:18,752 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 23:00:18,782 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 23:00:18,787 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 23:00:18,793 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 23:00:19,217 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 23:00:24,533 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 23:00:30,791 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 23:00:31,368 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 23:00:31,382 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 23:00:31,391 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (28946)
2025-12-01 23:00:31,395 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-01 23:00:31,395 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-01 23:00:31,396 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 23:00:31,396 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:00:31,396 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 23:00:31,396 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 23:00:31,396 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 23:00:31,397 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:00:31,397 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,142 字节，已等待 0 秒)
2025-12-01 23:00:33,398 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-01 23:00:37,401 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-01 23:00:41,423 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:00:41,423 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 23:00:41,424 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,142 字节
2025-12-01 23:00:41,424 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-01 23:00:41,424 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:00:41,428 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 23:00:41,452 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (10, 13)
2025-12-01 23:00:41,454 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 23:00:41,459 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (10, 12)
2025-12-01 23:00:41,459 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 23:00:41,538 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 23:00:41,543 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 23:00:41,546 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:00:41,546 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 23:00:41,547 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (28946)
2025-12-01 23:00:41,951 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:00:42,453 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 28946) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 23:00:42,952 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:00:43,477 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 23:00:43,478 | INFO | root | ================================================================================
2025-12-01 23:00:43,479 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 23:00:43,479 | INFO | root | ================================================================================
2025-12-01 23:00:43,479 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:00:43,481 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 23:00:43,481 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 23:00:43,503 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 23:00:45,503 | INFO | root | ================================================================================
2025-12-01 23:00:45,511 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 23:00:45,517 | INFO | root | ================================================================================
2025-12-01 23:00:45,560 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 23:00:45,574 | INFO | root | 执行批次 1/1，LOT 数：7
2025-12-01 23:00:45,575 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-01 23:00:45,576 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 23:00:45,577 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:00:45,578 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 23:00:45,579 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 23:00:45,602 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 23:00:46,608 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 23:00:48,464 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 23:00:48,473 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 30087) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 23:00:48,473 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 23:00:48,474 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 23:00:48,475 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已置于最顶层（HWND_TOPMOST）
2025-12-01 23:00:48,678 | INFO | prd_lot_automation.spf_runner | ✅ 窗口已保持在前台
2025-12-01 23:00:48,980 | INFO | prd_lot_automation.spf_runner | 窗口已激活（尝试 1/3）
2025-12-01 23:00:48,980 | INFO | prd_lot_automation.spf_runner | 等待1秒后发送 F8...
2025-12-01 23:00:50,195 | INFO | prd_lot_automation.spf_runner | ✅ 已通过 type_keys 发送 F8
2025-12-01 23:00:50,202 | INFO | prd_lot_automation.spf_runner | F8 快捷键已发送，等待弹窗出现...
2025-12-01 23:00:50,929 | INFO | prd_lot_automation.spf_runner | ✅ 检测到弹窗已出现: Prompt For Values (in)
2025-12-01 23:00:50,930 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 23:00:50,937 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 23:00:52,938 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 23:00:52,940 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 23:00:52,974 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 23:00:52,983 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 23:00:52,987 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 23:00:53,401 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 23:00:58,708 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: 等待 Paste 处理完成...
2025-12-01 23:01:05,310 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 23:01:05,976 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 23:01:05,976 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 23:01:16,007 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-01 23:01:18,008 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 23:01:18,038 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 23:01:18,038 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 23:01:18,041 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 23:01:18,465 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮 (auto_id='cmdPaste')
2025-12-01 23:01:23,788 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: 等待 Paste 处理完成...
2025-12-01 23:01:30,062 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 23:01:30,745 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 23:01:30,766 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 23:01:30,774 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 23:01:32,805 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 23:01:37,897 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 23:01:42,964 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 23:01:48,028 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 23:01:53,099 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 23:01:58,166 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 23:02:02,232 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 23:02:02,232 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 23:02:02,232 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-01 23:02:02,233 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 23:02:02,233 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:02:02,233 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 23:02:02,233 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 23:02:02,234 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 23:02:02,234 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:02:10,237 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-01 23:02:20,241 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-01 23:02:30,250 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-01 23:02:40,274 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-01 23:02:50,280 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-01 23:03:00,283 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-01 23:03:10,415 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-01 23:03:14,418 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 2,597,282 字节，已等待 72 秒)
2025-12-01 23:03:16,423 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 1/4)
2025-12-01 23:03:20,455 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 78 秒，稳定检查: 3/4)
2025-12-01 23:03:22,482 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:03:22,482 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 23:03:22,483 | INFO | prd_lot_automation.spf_runner |    文件大小: 2,597,282 字节
2025-12-01 23:03:22,483 | INFO | prd_lot_automation.spf_runner |    等待时间: 80 秒
2025-12-01 23:03:22,483 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:03:22,483 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 23:03:22,547 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 8592 行过滤到 5692 行
2025-12-01 23:03:22,552 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5692 行过滤到 1423 行
2025-12-01 23:03:22,553 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 8592 行过滤到 1423 行
2025-12-01 23:03:22,561 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 23:03:22,576 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 23:03:22,581 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 23:03:22,586 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 8592 行过滤到 2900 行
2025-12-01 23:03:22,590 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2900 行过滤到 725 行
2025-12-01 23:03:22,590 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 8592 行过滤到 725 行
2025-12-01 23:03:22,596 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 23:03:22,602 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 23:03:22,605 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 23:03:24,319 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 23:03:24,320 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 23:03:24,321 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:03:24,322 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 23:03:24,325 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (30087)
2025-12-01 23:03:24,730 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:03:25,236 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 30087) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 23:03:25,684 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:03:26,346 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 23:03:26,359 | INFO | root | ================================================================================
2025-12-01 23:03:26,368 | INFO | root | 发送统一邮件
2025-12-01 23:03:26,371 | INFO | root | ================================================================================
2025-12-01 23:03:26,388 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 23:03:26,396 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Prod_PHI.xlsx
2025-12-01 23:03:26,452 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-01 23:03:26,482 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-01 23:03:26,508 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-01 23:03:26,540 | INFO | root | PHI 数据前5行:
2025-12-01 23:03:26,555 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:03:26,559 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:03:26,567 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:03:26,568 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:03:26,575 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-01 23:03:26,577 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-01 23:03:26,589 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,598 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,599 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,600 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,600 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-01 23:03:26,601 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,606 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,607 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,608 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,610 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,614 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,616 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,617 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,618 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,633 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,634 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,636 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,636 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,638 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,639 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,639 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,640 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,641 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-01 23:03:26,643 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,643 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,645 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,648 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-01 23:03:26,648 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,649 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,649 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,651 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH2VEB
2025-12-01 23:03:26,659 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,660 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,660 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,662 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH4VEB
2025-12-01 23:03:26,663 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,664 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,664 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:26,665 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH5VEB
2025-12-01 23:03:26,665 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:03:26,668 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:03:26,674 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:03:27,039 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 23:03:27,076 | INFO | root | ================================================================================
2025-12-01 23:03:27,089 | INFO | root | ✅ 统一自动化完成
2025-12-01 23:03:27,091 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 23:03:27,091 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 23:03:27,091 | INFO | root | ================================================================================
2025-12-01 23:34:43,697 | INFO | root | ================================================================================
2025-12-01 23:34:43,698 | INFO | root | 统一自动化开始
2025-12-01 23:34:43,698 | INFO | root | ================================================================================
2025-12-01 23:34:43,698 | INFO | root | ================================================================================
2025-12-01 23:34:43,698 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-01 23:34:43,699 | INFO | root | ================================================================================
2025-12-01 23:34:43,715 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 23:34:43,715 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-01 23:34:43,721 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 23:34:43,723 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:34:43,724 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 23:34:43,724 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 23:34:43,826 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 23:34:44,830 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lab_Class_Data_Performance.VG2
2025-12-01 23:34:46,777 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 23:34:46,778 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 19903) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 23:34:46,783 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 23:34:46,783 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 23:34:48,098 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-01 23:34:50,604 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 23:34:50,604 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 23:34:52,605 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 23:34:52,605 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 23:34:52,636 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 23:34:52,637 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 23:34:52,645 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 23:34:53,468 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-01 23:34:54,606 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 23:34:55,193 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 23:34:55,200 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 23:34:55,208 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (19903)
2025-12-01 23:34:55,209 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-01 23:34:55,209 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-01 23:34:55,209 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 23:34:55,209 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:34:55,210 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 23:34:55,210 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 23:34:55,210 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 23:34:55,210 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:34:55,210 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,142 字节，已等待 0 秒)
2025-12-01 23:34:57,211 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-01 23:35:01,226 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-01 23:35:05,230 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:35:05,230 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 23:35:05,230 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,142 字节
2025-12-01 23:35:05,230 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-01 23:35:05,231 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:35:05,235 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-01 23:35:05,249 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (10, 13)
2025-12-01 23:35:05,250 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-01 23:35:05,256 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (10, 12)
2025-12-01 23:35:05,256 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 23:35:05,305 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 23:35:05,305 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 23:35:05,306 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:35:05,307 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 23:35:05,307 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (19903)
2025-12-01 23:35:05,792 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:35:06,303 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 19903) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-01 23:35:06,771 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:35:07,296 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 23:35:07,296 | INFO | root | ================================================================================
2025-12-01 23:35:07,297 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-01 23:35:07,297 | INFO | root | ================================================================================
2025-12-01 23:35:07,297 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:35:07,298 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 23:35:07,299 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 23:35:07,308 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 23:35:09,309 | INFO | root | ================================================================================
2025-12-01 23:35:09,309 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-01 23:35:09,309 | INFO | root | ================================================================================
2025-12-01 23:35:09,319 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 23:35:09,320 | INFO | root | 执行批次 1/1，LOT 数：7
2025-12-01 23:35:09,320 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-01 23:35:09,321 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-01 23:35:09,321 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:35:09,322 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-01 23:35:09,322 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-01 23:35:09,329 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-01 23:35:10,331 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-01 23:35:12,084 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-01 23:35:12,084 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 1689) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 23:35:12,085 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-01 23:35:12,085 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-01 23:35:13,401 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-01 23:35:15,908 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-01 23:35:15,908 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-01 23:35:17,909 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-01 23:35:17,909 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-01 23:35:17,934 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-01 23:35:17,934 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 23:35:17,938 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 23:35:18,319 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-01 23:35:19,521 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-01 23:35:20,085 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 23:35:20,085 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-01 23:35:30,118 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-01 23:35:32,119 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-01 23:35:32,145 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-01 23:35:32,145 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-01 23:35:32,148 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-01 23:35:32,530 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-01 23:35:33,724 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-01 23:35:34,374 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-01 23:35:34,380 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-01 23:35:34,389 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-01 23:35:36,428 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-01 23:35:41,502 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-01 23:35:46,568 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-01 23:35:51,634 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-01 23:35:56,701 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-01 23:36:01,770 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-01 23:36:06,835 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-01 23:36:06,836 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-01 23:36:06,836 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-01 23:36:06,836 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-01 23:36:06,836 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:36:06,837 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-01 23:36:06,837 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 23:36:06,837 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-01 23:36:06,837 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:36:14,840 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-01 23:36:24,844 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-01 23:36:34,848 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-01 23:36:44,851 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-01 23:36:54,855 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-01 23:37:04,859 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-01 23:37:14,862 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-01 23:37:16,863 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 2,597,282 字节，已等待 70 秒)
2025-12-01 23:37:20,868 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-01 23:37:24,870 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:37:24,871 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 23:37:24,871 | INFO | prd_lot_automation.spf_runner |    文件大小: 2,597,282 字节
2025-12-01 23:37:24,871 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-01 23:37:24,872 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-01 23:37:24,872 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-01 23:37:24,932 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 8592 行过滤到 5692 行
2025-12-01 23:37:24,935 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 5692 行过滤到 1423 行
2025-12-01 23:37:24,936 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 8592 行过滤到 1423 行
2025-12-01 23:37:24,943 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 23:37:24,954 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 23:37:24,959 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-01 23:37:24,964 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 8592 行过滤到 2900 行
2025-12-01 23:37:24,965 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2900 行过滤到 725 行
2025-12-01 23:37:24,966 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 8592 行过滤到 725 行
2025-12-01 23:37:24,970 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-01 23:37:24,976 | INFO | root | Retest Bin Pareto 生成完成
2025-12-01 23:37:24,977 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 23:37:26,630 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 23:37:26,631 | INFO | root | 关闭 SQLPathFinder...
2025-12-01 23:37:26,631 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-01 23:37:26,632 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-01 23:37:26,633 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (1689)
2025-12-01 23:37:27,036 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:37:27,537 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 1689) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-01 23:37:27,964 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-01 23:37:28,521 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-01 23:37:28,523 | INFO | root | ================================================================================
2025-12-01 23:37:28,527 | INFO | root | 发送统一邮件
2025-12-01 23:37:28,527 | INFO | root | ================================================================================
2025-12-01 23:37:28,539 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Lot info.txt）
2025-12-01 23:37:28,540 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\Prod_PHI.xlsx
2025-12-01 23:37:28,597 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-01 23:37:28,607 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-01 23:37:28,614 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-01 23:37:28,615 | INFO | root | PHI 数据前5行:
2025-12-01 23:37:28,616 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:37:28,616 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:37:28,616 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:37:28,617 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-01 23:37:28,618 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-01 23:37:28,618 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-01 23:37:28,624 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,625 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,625 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,631 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,633 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-01 23:37:28,650 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,663 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,680 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,694 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,696 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,698 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,698 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,700 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,701 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,703 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,705 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,706 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,707 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,709 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,710 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,710 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,710 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,712 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-01 23:37:28,713 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,714 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,714 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,716 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-01 23:37:28,716 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,716 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,717 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,718 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH2VEB
2025-12-01 23:37:28,718 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,718 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,722 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,724 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH4VEB
2025-12-01 23:37:28,724 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,726 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,726 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,728 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH5VEB
2025-12-01 23:37:28,728 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-01 23:37:28,728 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-01 23:37:28,729 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-01 23:37:28,882 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-01 23:37:28,896 | INFO | root | ================================================================================
2025-12-01 23:37:28,898 | INFO | root | ✅ 统一自动化完成
2025-12-01 23:37:28,899 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\Lab_TP_Performance_20251201.xlsx
2025-12-01 23:37:28,899 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\Test Data Auto analysis\reports\LOT_Report_2025-12-01.xlsx
2025-12-01 23:37:28,899 | INFO | root | ================================================================================
2025-12-16 19:34:31,031 | INFO | root | ================================================================================
2025-12-16 19:34:31,031 | INFO | root | 统一自动化开始
2025-12-16 19:34:31,031 | INFO | root | ================================================================================
2025-12-16 19:34:31,031 | INFO | root | ================================================================================
2025-12-16 19:34:31,031 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 19:34:31,031 | INFO | root | ================================================================================
2025-12-16 19:34:31,046 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 19:34:31,046 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-16 19:34:31,046 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 19:34:31,046 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:34:31,046 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 19:34:31,046 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 19:34:31,160 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 19:34:32,172 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 19:34:37,539 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 19:34:37,539 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 16344) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 19:34:37,539 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 19:34:37,539 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 19:34:38,867 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 19:34:41,373 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 19:34:41,373 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 19:34:43,374 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 19:34:43,374 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 19:34:43,391 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 19:34:43,391 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 19:34:43,391 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-16 19:34:43,783 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 19:34:45,004 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 19:34:45,580 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 19:34:45,600 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 19:34:45,625 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (16344)
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 19:34:45,631 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:34:51,641 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,142 字节，已等待 6 秒)
2025-12-16 19:34:55,669 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 10 秒，稳定检查: 2/4)
2025-12-16 19:34:59,671 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:34:59,671 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 19:34:59,671 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,142 字节
2025-12-16 19:34:59,671 | INFO | prd_lot_automation.spf_runner |    等待时间: 14 秒
2025-12-16 19:34:59,671 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:34:59,688 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 19:34:59,728 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (10, 13)
2025-12-16 19:34:59,728 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 19:34:59,728 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (10, 12)
2025-12-16 19:34:59,728 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 19:34:59,807 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 19:34:59,807 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 19:34:59,807 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:34:59,812 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 19:34:59,812 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (16344)
2025-12-16 19:35:00,219 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 19:35:00,721 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 16344) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 19:35:01,306 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 19:35:01,816 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 19:35:01,816 | INFO | root | ================================================================================
2025-12-16 19:35:01,816 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 19:35:01,816 | INFO | root | ================================================================================
2025-12-16 19:35:01,816 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:35:01,816 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 19:35:01,816 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 19:35:01,816 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 19:35:03,830 | INFO | root | ================================================================================
2025-12-16 19:35:03,830 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 19:35:03,844 | INFO | root | ================================================================================
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 19:35:03,859 | INFO | root | 执行批次 1/1，LOT 数：7
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：7
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 19:35:03,859 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 19:35:04,875 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 19:35:10,069 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 19:35:10,069 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 25851) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 19:35:10,069 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 19:35:10,069 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 19:35:11,386 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 19:35:13,895 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 19:35:13,895 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 19:35:15,896 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 19:35:15,896 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 19:35:15,906 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 19:35:15,922 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 19:35:15,922 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-16 19:35:16,284 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 19:35:17,515 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 19:35:18,052 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 19:35:18,052 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 19:35:28,079 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 19:35:30,080 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 19:35:30,094 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 19:35:30,106 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 19:35:30,106 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (7 个，使用 win32clipboard)
2025-12-16 19:35:30,471 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 19:35:31,817 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 19:35:32,368 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 19:35:32,368 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 19:35:32,368 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 19:35:34,375 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 19:35:39,425 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 19:35:44,478 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 19:35:49,529 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 19:35:54,574 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 19:35:59,624 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 19:36:04,675 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：7
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 19:36:04,675 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:36:12,680 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 19:36:22,683 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 19:36:32,687 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 19:36:42,690 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 19:36:52,693 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 19:37:02,696 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 19:37:12,700 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 19:37:14,701 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,915,502 字节，已等待 70 秒)
2025-12-16 19:37:18,707 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 19:37:22,709 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:37:22,709 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 19:37:22,717 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,915,502 字节
2025-12-16 19:37:22,719 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 19:37:22,719 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:37:22,719 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 19:37:22,782 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6333 行过滤到 4215 行
2025-12-16 19:37:22,782 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 4215 行过滤到 0 行
2025-12-16 19:37:22,782 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6333 行过滤到 0 行
2025-12-16 19:37:22,782 | INFO | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 以数值方式求和
2025-12-16 19:37:22,797 | INFO | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 以数值方式求和
2025-12-16 19:37:22,797 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 19:37:22,813 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6333 行过滤到 2118 行
2025-12-16 19:37:22,813 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 2118 行过滤到 0 行
2025-12-16 19:37:22,813 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6333 行过滤到 0 行
2025-12-16 19:37:22,813 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 19:37:22,907 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 19:37:22,907 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 19:37:22,907 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:37:22,907 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 19:37:22,907 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (25851)
2025-12-16 19:37:23,323 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 19:37:23,824 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 25851) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 19:37:24,331 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 19:37:24,894 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 19:37:24,894 | INFO | root | ================================================================================
2025-12-16 19:37:24,894 | INFO | root | 发送统一邮件
2025-12-16 19:37:24,894 | INFO | root | ================================================================================
2025-12-16 19:37:24,907 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：7 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 19:37:24,919 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 19:37:24,951 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 19:37:24,951 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 19:37:24,951 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 19:37:24,951 | INFO | root | PHI 数据前5行:
2025-12-16 19:37:24,951 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 19:37:24,951 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 19:37:24,951 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 19:37:24,951 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 19:37:24,951 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 19:37:24,951 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 19:37:24,966 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,966 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,966 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,966 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,966 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 19:37:24,966 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,969 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,969 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,969 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,969 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,983 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,983 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,983 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,983 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH2VEB
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,983 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:24,998 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH4VEB
2025-12-16 19:37:24,998 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:24,998 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:24,998 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:25,001 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSCOLD, Devrevstep=4PLH5VEB
2025-12-16 19:37:25,001 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 19:37:25,001 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 19:37:25,014 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 19:37:29,001 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 19:37:29,094 | INFO | root | ================================================================================
2025-12-16 19:37:29,142 | INFO | root | ✅ 统一自动化完成
2025-12-16 19:37:29,173 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 19:37:29,235 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 19:37:29,375 | INFO | root | ================================================================================
2025-12-16 19:58:44,178 | INFO | root | ================================================================================
2025-12-16 19:58:44,178 | INFO | root | 统一自动化开始
2025-12-16 19:58:44,178 | INFO | root | ================================================================================
2025-12-16 19:58:44,178 | INFO | root | ================================================================================
2025-12-16 19:58:44,193 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 19:58:44,193 | INFO | root | ================================================================================
2025-12-16 19:58:44,193 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 19:58:44,193 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 19:58:44,193 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 19:58:44,193 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:58:44,193 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 19:58:44,193 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 19:58:44,303 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 19:58:45,304 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 19:58:50,617 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 19:58:50,617 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 1958) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 19:58:50,617 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 19:58:50,617 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 19:58:51,937 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 19:58:54,443 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 19:58:54,443 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 19:58:56,445 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 19:58:56,445 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 19:58:56,475 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 19:58:56,476 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 19:58:56,476 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 19:58:56,850 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 19:58:58,056 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 19:58:58,745 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 19:58:58,768 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 19:58:58,783 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (1958)
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 19:58:58,787 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:58:58,800 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,142 字节，已等待 0 秒)
2025-12-16 19:59:00,801 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 19:59:04,805 | INFO | prd_lot_automation.spf_runner | 📝 文件正在写入中... (大小: 1,142 → 1,649 字节，已等待 6 秒)
2025-12-16 19:59:08,809 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 10 秒，稳定检查: 2/4)
2025-12-16 19:59:12,811 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:59:12,811 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 19:59:12,811 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 19:59:12,811 | INFO | prd_lot_automation.spf_runner |    等待时间: 14 秒
2025-12-16 19:59:12,811 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 19:59:12,811 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 19:59:12,819 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 19:59:12,835 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 19:59:12,835 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 19:59:12,835 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 19:59:12,930 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 19:59:12,930 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 19:59:12,930 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:59:12,930 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 19:59:12,930 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (1958)
2025-12-16 19:59:13,344 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 19:59:13,849 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 1958) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 19:59:14,304 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 19:59:14,897 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 19:59:14,897 | INFO | root | ================================================================================
2025-12-16 19:59:14,897 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 19:59:14,897 | INFO | root | ================================================================================
2025-12-16 19:59:14,897 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:59:14,897 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 19:59:14,897 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 19:59:14,912 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 19:59:16,917 | INFO | root | ================================================================================
2025-12-16 19:59:16,917 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 19:59:16,917 | INFO | root | ================================================================================
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 19:59:16,928 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 19:59:16,928 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 19:59:17,943 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 19:59:23,136 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 19:59:23,136 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 31932) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 19:59:23,136 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 19:59:23,136 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 19:59:24,459 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 19:59:26,967 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 19:59:26,967 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 19:59:28,968 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 19:59:28,968 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 19:59:28,985 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 19:59:28,985 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 19:59:28,985 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 19:59:29,352 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 19:59:30,566 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 19:59:31,211 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 19:59:31,211 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 19:59:41,236 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 19:59:43,237 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 19:59:43,256 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 19:59:43,256 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 19:59:43,256 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 19:59:43,629 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 19:59:44,839 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 19:59:45,370 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 19:59:45,398 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 19:59:45,408 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 19:59:47,438 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 19:59:52,492 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 19:59:57,546 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 20:00:02,597 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 20:00:07,649 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 20:00:12,700 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 20:00:17,751 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 20:00:17,751 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:00:25,756 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 20:00:35,759 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 20:00:45,763 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 20:00:55,767 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 20:01:05,770 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 20:01:15,773 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 20:01:25,777 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 20:01:27,778 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-16 20:01:31,810 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 20:01:35,812 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:01:35,812 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 20:01:35,812 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 20:01:35,812 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 20:01:35,812 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:01:35,812 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 20:01:35,852 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 20:01:35,867 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 4527 行过滤到 0 行
2025-12-16 20:01:35,867 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 20:01:35,867 | INFO | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 以数值方式求和
2025-12-16 20:01:35,883 | INFO | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 以数值方式求和
2025-12-16 20:01:35,883 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 20:01:35,883 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 20:01:35,883 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 1548 行过滤到 0 行
2025-12-16 20:01:35,899 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 20:01:35,899 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 20:01:35,947 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 20:01:35,947 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 20:01:35,963 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 20:01:35,963 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 20:01:35,963 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (31932)
2025-12-16 20:01:36,373 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 20:01:36,874 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 31932) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 20:01:37,354 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 20:01:37,911 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 20:01:37,913 | INFO | root | ================================================================================
2025-12-16 20:01:37,913 | INFO | root | 发送统一邮件
2025-12-16 20:01:37,913 | INFO | root | ================================================================================
2025-12-16 20:01:37,925 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 20:01:37,925 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 20:01:37,957 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 20:01:37,957 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 20:01:37,957 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 20:01:37,957 | INFO | root | PHI 数据前5行:
2025-12-16 20:01:37,957 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:01:37,957 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:01:37,957 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:01:37,957 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:01:37,957 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 20:01:37,957 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 20:01:37,975 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 20:01:37,975 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:37,975 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:37,975 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:37,975 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 20:01:37,975 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 20:01:37,975 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 20:01:37,975 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:37,975 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:37,975 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:37,989 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:37,989 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:37,989 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 20:01:37,989 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,004 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,004 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 20:01:38,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,020 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,020 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,020 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,020 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,020 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,020 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,020 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,052 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,052 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:38,052 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:01:38,052 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:01:41,647 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 20:01:41,694 | INFO | root | ================================================================================
2025-12-16 20:01:41,710 | INFO | root | ✅ 统一自动化完成
2025-12-16 20:01:41,710 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 20:01:41,710 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 20:01:41,710 | INFO | root | ================================================================================
2025-12-16 20:10:32,118 | INFO | root | ================================================================================
2025-12-16 20:10:32,118 | INFO | root | 统一自动化开始
2025-12-16 20:10:32,133 | INFO | root | ================================================================================
2025-12-16 20:10:32,133 | INFO | root | ================================================================================
2025-12-16 20:10:32,133 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 20:10:32,133 | INFO | root | ================================================================================
2025-12-16 20:10:32,149 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 20:10:32,149 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 20:10:32,149 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 20:10:32,149 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 20:10:32,149 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 20:10:32,149 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 20:10:32,258 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 20:10:33,274 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 20:10:38,587 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 20:10:38,587 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 24737) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 20:10:38,587 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 20:10:38,603 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 20:10:39,918 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 20:10:42,428 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 20:10:42,428 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 20:10:44,430 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 20:10:44,430 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 20:10:44,446 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 20:10:44,446 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 20:10:44,459 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 20:10:44,822 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 20:10:46,041 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 20:10:46,713 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 20:10:46,727 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 20:10:46,739 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (24737)
2025-12-16 20:10:46,739 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 20:10:46,739 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 20:10:46,739 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 20:10:46,755 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:10:46,771 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 20:10:46,789 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 20:10:46,802 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 20:10:46,802 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:10:46,818 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 20:10:48,820 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 20:10:52,826 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-16 20:10:56,843 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:10:56,843 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 20:10:56,843 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 20:10:56,843 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-16 20:10:56,843 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:10:56,859 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 20:10:56,890 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 20:10:56,906 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 20:10:56,906 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 20:10:56,906 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 20:10:56,977 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 20:10:56,977 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 20:10:56,985 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 20:10:56,985 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 20:10:56,985 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (24737)
2025-12-16 20:10:57,390 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 20:10:57,891 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 24737) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 20:10:58,352 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 20:10:58,899 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 20:10:58,899 | INFO | root | ================================================================================
2025-12-16 20:10:58,899 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 20:10:58,899 | INFO | root | ================================================================================
2025-12-16 20:10:58,899 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 20:10:58,899 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 20:10:58,899 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 20:10:58,914 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 20:11:00,925 | INFO | root | ================================================================================
2025-12-16 20:11:00,930 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 20:11:00,930 | INFO | root | ================================================================================
2025-12-16 20:11:00,946 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 20:11:00,962 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 20:11:00,962 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 20:11:00,962 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 20:11:00,962 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 20:11:00,962 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 20:11:00,977 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 20:11:00,993 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 20:11:02,008 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 20:11:07,201 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 20:11:07,201 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 15002) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 20:11:07,201 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 20:11:07,201 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 20:11:08,525 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 20:11:11,032 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 20:11:11,032 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 20:11:13,034 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 20:11:13,034 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 20:11:13,055 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 20:11:13,055 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 20:11:13,055 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 20:11:13,421 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 20:11:14,621 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 20:11:15,237 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 20:11:15,240 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 20:11:25,292 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 20:11:27,293 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 20:11:27,306 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 20:11:27,306 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 20:11:27,306 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 20:11:27,696 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 20:11:28,870 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 20:11:29,509 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 20:11:29,521 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 20:11:29,521 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 20:11:31,533 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 20:11:36,596 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 20:11:41,652 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 20:11:46,705 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 20:11:51,759 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 20:11:56,815 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 20:12:01,871 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 20:12:01,871 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:12:09,876 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 20:12:19,879 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 20:12:29,889 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 20:12:39,900 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 20:12:49,955 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 20:12:59,958 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 20:13:09,961 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 20:13:11,963 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-16 20:13:15,967 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 20:13:19,968 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:13:19,968 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 20:13:19,968 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 20:13:19,968 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 20:13:19,968 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 20:13:19,968 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 20:13:20,010 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 20:13:20,010 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 4527 行过滤到 0 行
2025-12-16 20:13:20,025 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 20:13:20,025 | INFO | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 以数值方式求和
2025-12-16 20:13:20,025 | INFO | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 以数值方式求和
2025-12-16 20:13:20,025 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 20:13:20,041 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 20:13:20,041 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 1548 行过滤到 0 行
2025-12-16 20:13:20,041 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 20:13:20,041 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 20:13:20,121 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 20:13:20,121 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 20:13:20,121 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 20:13:20,121 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 20:13:20,121 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (15002)
2025-12-16 20:13:20,532 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 20:13:21,040 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 15002) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 20:13:21,465 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 20:13:22,064 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 20:13:22,064 | INFO | root | ================================================================================
2025-12-16 20:13:22,068 | INFO | root | 发送统一邮件
2025-12-16 20:13:22,068 | INFO | root | ================================================================================
2025-12-16 20:13:22,071 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 20:13:22,071 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 20:13:22,102 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 20:13:22,102 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 20:13:22,102 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 20:13:22,102 | INFO | root | PHI 数据前5行:
2025-12-16 20:13:22,102 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:13:22,116 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:13:22,116 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:13:22,116 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 20:13:22,116 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 20:13:22,116 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 20:13:22,116 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,116 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,116 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,116 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,116 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 20:13:22,116 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,116 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,116 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,116 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,116 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,131 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,131 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,133 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,133 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,133 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,147 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,147 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,147 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 20:13:22,147 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,163 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,163 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,165 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,165 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,165 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,165 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,179 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,179 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,179 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,179 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:22,179 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 20:13:22,179 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 20:13:25,368 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 20:13:25,430 | INFO | root | ================================================================================
2025-12-16 20:13:25,430 | INFO | root | ✅ 统一自动化完成
2025-12-16 20:13:25,430 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 20:13:25,430 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 20:13:25,446 | INFO | root | ================================================================================
2025-12-16 21:43:58,295 | INFO | root | ================================================================================
2025-12-16 21:43:58,311 | INFO | root | 统一自动化开始
2025-12-16 21:43:58,311 | INFO | root | ================================================================================
2025-12-16 21:43:58,311 | INFO | root | ================================================================================
2025-12-16 21:43:58,311 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 21:43:58,311 | INFO | root | ================================================================================
2025-12-16 21:43:58,327 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 21:43:58,327 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 21:43:58,343 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 21:43:58,343 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:43:58,359 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 21:43:58,359 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 21:43:58,498 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 21:43:59,529 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 21:44:05,132 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 21:44:05,132 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 23066) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 21:44:05,132 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 21:44:05,132 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 21:44:06,459 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 21:44:08,965 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 21:44:08,965 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 21:44:10,966 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 21:44:10,966 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 21:44:10,983 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 21:44:10,983 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 21:44:10,983 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 21:44:11,374 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 21:44:12,577 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 21:44:13,174 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 21:44:13,186 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 21:44:13,201 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (23066)
2025-12-16 21:44:13,201 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 21:44:13,217 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 21:44:13,233 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 21:44:13,233 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:44:13,248 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 21:44:13,264 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 21:44:13,264 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 21:44:13,264 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:44:13,264 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 21:44:15,276 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 21:44:19,280 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-16 21:44:23,286 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:44:23,286 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 21:44:23,286 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 21:44:23,286 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-16 21:44:23,286 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:44:23,286 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 21:44:23,293 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 21:44:23,293 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 21:44:23,311 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 21:44:23,311 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 21:44:23,374 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 21:44:23,388 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 21:44:23,388 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:44:23,388 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 21:44:23,388 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (23066)
2025-12-16 21:44:23,799 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 21:44:24,300 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 23066) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 21:44:24,709 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 21:44:25,314 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 21:44:25,314 | INFO | root | ================================================================================
2025-12-16 21:44:25,314 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 21:44:25,314 | INFO | root | ================================================================================
2025-12-16 21:44:25,314 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:44:25,314 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 21:44:25,314 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 21:44:25,314 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 21:44:27,327 | INFO | root | ================================================================================
2025-12-16 21:44:27,327 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 21:44:27,327 | INFO | root | ================================================================================
2025-12-16 21:44:27,342 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 21:44:27,342 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 21:44:27,342 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 21:44:27,342 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 21:44:27,342 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:44:27,342 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 21:44:27,342 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 21:44:27,358 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 21:44:28,373 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 21:44:33,549 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 21:44:33,549 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 3825) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 21:44:33,549 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 21:44:33,549 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 21:44:34,878 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 21:44:37,385 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 21:44:37,385 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 21:44:39,386 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 21:44:39,386 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 21:44:39,424 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 21:44:39,440 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 21:44:39,440 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 21:44:39,863 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 21:44:41,156 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 21:44:41,743 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 21:44:41,743 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 21:44:51,769 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 21:44:53,770 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 21:44:53,780 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 21:44:53,795 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 21:44:53,795 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 21:44:54,158 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 21:44:55,527 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 21:44:56,142 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 21:44:56,171 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 21:44:56,186 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 21:44:58,215 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 21:45:03,296 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 21:45:08,357 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 21:45:13,415 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 21:45:18,472 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 21:45:23,522 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 21:45:28,573 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 21:45:28,573 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 21:45:28,573 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 21:45:28,573 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 21:45:28,581 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:45:28,581 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 21:45:28,581 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 21:45:28,581 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 21:45:28,581 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:45:36,592 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 21:45:46,595 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 21:45:56,606 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 21:46:06,609 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 21:46:16,613 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 21:46:26,617 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 21:46:36,621 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 21:46:38,624 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-16 21:46:42,633 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 21:46:46,635 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:46:46,635 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 21:46:46,635 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 21:46:46,641 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 21:46:46,641 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:46:46,641 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 21:46:46,689 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-16 21:46:46,689 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 21:46:46,704 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 4527 行过滤到 0 行
2025-12-16 21:46:46,704 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 21:46:46,704 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 0
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing | ⚠️ 警告：应用过滤条件后数据为空！
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing |    过滤条件: {'mut_within_subflow_latest_flag': 'Y', 'SUBSTRUCTURE_ID': 'U1.U1'}
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing |    可能的原因：
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing |    1. 过滤条件太严格，没有数据满足条件
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing |    2. 列名不匹配（检查大小写、下划线等）
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing |    3. 数据中确实没有满足条件的数据
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing |    建议：检查 config.yaml 中的 filters 配置，或查看原始数据
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.data_processing | ⚠️ 警告：FUNCTIONAL_BIN 数据为空，无法构建数量表
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.report_builder | ⚠️ 警告：quantity 表为空，生成的 Pareto 表将只包含 Grand Total 行（值为 0）
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.report_builder |    可能的原因：
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.report_builder |    1. 数据被过滤条件全部过滤掉了
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.report_builder |    2. 数据中没有有效的 functional_bin 或 devrevstep 值
2025-12-16 21:46:46,704 | WARNING | prd_lot_automation.report_builder |    3. 列名不匹配
2025-12-16 21:46:46,721 | WARNING | prd_lot_automation.data_processing | ⚠️ 警告：INTERFACE_BIN 数据为空，无法构建数量表
2025-12-16 21:46:46,721 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 21:46:46,736 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 21:46:46,736 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 1548 行过滤到 0 行
2025-12-16 21:46:46,736 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 21:46:46,736 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 21:46:46,816 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 21:46:46,831 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 21:46:46,863 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:46:46,863 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 21:46:46,863 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (3825)
2025-12-16 21:46:47,331 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 21:46:47,841 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 3825) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 21:46:48,569 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 21:46:49,080 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 21:46:49,080 | INFO | root | ================================================================================
2025-12-16 21:46:49,080 | INFO | root | 发送统一邮件
2025-12-16 21:46:49,080 | INFO | root | ================================================================================
2025-12-16 21:46:49,094 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 21:46:49,094 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 21:46:49,125 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 21:46:49,125 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 21:46:49,125 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 21:46:49,125 | INFO | root | PHI 数据前5行:
2025-12-16 21:46:49,125 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 21:46:49,125 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 21:46:49,125 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 21:46:49,125 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 21:46:49,125 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 21:46:49,125 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 21:46:49,136 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,136 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,136 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,136 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,136 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 21:46:49,136 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,136 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,136 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,136 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,136 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,136 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,152 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,152 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,152 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,152 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,152 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,152 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,152 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,156 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,156 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,156 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,156 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,168 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,168 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,168 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,168 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,168 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,168 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,184 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 21:46:49,184 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,184 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,184 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,184 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 21:46:49,184 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,187 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,187 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,200 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,200 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,200 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:49,200 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 21:46:49,200 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 21:46:49,215 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 21:46:52,500 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 21:46:52,500 | INFO | root | ================================================================================
2025-12-16 21:46:52,500 | INFO | root | ✅ 统一自动化完成
2025-12-16 21:46:52,515 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 21:46:52,515 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 21:46:52,515 | INFO | root | ================================================================================
2025-12-16 21:58:11,421 | INFO | root | ================================================================================
2025-12-16 21:58:11,423 | INFO | root | 统一自动化开始
2025-12-16 21:58:11,423 | INFO | root | ================================================================================
2025-12-16 21:58:11,424 | INFO | root | ================================================================================
2025-12-16 21:58:11,426 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 21:58:11,427 | INFO | root | ================================================================================
2025-12-16 21:58:11,438 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 21:58:11,439 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 21:58:11,439 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 21:58:11,441 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:58:11,448 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 21:58:11,449 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 21:58:11,557 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 21:58:12,573 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 21:58:17,888 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 21:58:17,889 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 14840) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 21:58:17,890 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 21:58:17,890 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 21:58:19,216 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 21:58:21,744 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 21:58:21,744 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 21:58:23,745 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 21:58:23,746 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 21:58:23,772 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 21:58:23,777 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 21:58:23,784 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 21:58:24,167 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 21:58:25,409 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 21:58:26,058 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 21:58:26,086 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 21:58:26,096 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (14840)
2025-12-16 21:58:26,136 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 21:58:26,146 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 21:58:26,148 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 21:58:26,148 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:58:26,149 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 21:58:26,149 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 21:58:26,149 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 21:58:26,150 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:58:26,150 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 21:58:28,152 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 21:58:32,163 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 3/4)
2025-12-16 21:58:34,172 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:58:34,174 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 21:58:34,178 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 21:58:34,178 | INFO | prd_lot_automation.spf_runner |    等待时间: 8 秒
2025-12-16 21:58:34,179 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:58:34,182 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 21:58:34,196 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 21:58:34,217 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 21:58:34,228 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 21:58:34,249 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 21:58:34,356 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 21:58:34,372 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 21:58:34,376 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:58:34,376 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 21:58:34,377 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (14840)
2025-12-16 21:58:34,787 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 21:58:35,288 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 14840) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 21:58:35,924 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 21:58:36,428 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 21:58:36,428 | INFO | root | ================================================================================
2025-12-16 21:58:36,429 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 21:58:36,429 | INFO | root | ================================================================================
2025-12-16 21:58:36,429 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:58:36,431 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 21:58:36,431 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 21:58:36,438 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 21:58:38,439 | INFO | root | ================================================================================
2025-12-16 21:58:38,440 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 21:58:38,440 | INFO | root | ================================================================================
2025-12-16 21:58:38,462 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 21:58:38,462 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 21:58:38,463 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 21:58:38,463 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 21:58:38,463 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 21:58:38,464 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 21:58:38,464 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 21:58:38,470 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 21:58:39,482 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 21:58:44,670 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 21:58:44,671 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 11064) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 21:58:44,671 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 21:58:44,671 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 21:58:45,987 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 21:58:48,493 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 21:58:48,494 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 21:58:50,494 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 21:58:50,495 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 21:58:50,519 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 21:58:50,519 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 21:58:50,523 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 21:58:50,881 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 21:58:52,077 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 21:58:52,689 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 21:58:52,690 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 21:59:02,718 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 21:59:04,719 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 21:59:04,745 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 21:59:04,746 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 21:59:04,749 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 21:59:05,132 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 21:59:06,263 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 21:59:06,787 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 21:59:06,796 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 21:59:06,822 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 21:59:08,845 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 21:59:13,902 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 21:59:18,954 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 21:59:24,004 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 21:59:29,059 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 21:59:34,111 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 21:59:39,168 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 21:59:39,168 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 21:59:39,168 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 21:59:39,168 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 21:59:39,168 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:59:39,169 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 21:59:39,169 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 21:59:39,169 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 21:59:39,169 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 21:59:47,173 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 21:59:57,177 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 22:00:07,180 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 22:00:17,184 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 22:00:27,188 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 22:00:37,191 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 22:00:47,195 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 22:00:51,197 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 72 秒)
2025-12-16 22:00:53,212 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 1/4)
2025-12-16 22:00:57,220 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 78 秒，稳定检查: 3/4)
2025-12-16 22:00:59,222 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 22:00:59,222 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 22:00:59,223 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 22:00:59,223 | INFO | prd_lot_automation.spf_runner |    等待时间: 80 秒
2025-12-16 22:00:59,223 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 22:00:59,223 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 22:00:59,272 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-16 22:00:59,280 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 22:00:59,282 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 4527 行过滤到 1509 行
2025-12-16 22:00:59,283 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 1509 行
2025-12-16 22:00:59,284 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 1509
2025-12-16 22:00:59,285 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 1509
2025-12-16 22:00:59,293 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 22:00:59,300 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (80, 3)
2025-12-16 22:00:59,306 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 1509
2025-12-16 22:00:59,309 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 22:00:59,310 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (26, 3)
2025-12-16 22:00:59,316 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 22:00:59,329 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 22:00:59,333 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U1，从 1548 行过滤到 0 行
2025-12-16 22:00:59,333 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 0 行
2025-12-16 22:00:59,336 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 22:01:00,978 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 22:01:00,981 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 22:01:00,983 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 22:01:00,983 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 22:01:00,984 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (11064)
2025-12-16 22:01:01,386 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 22:01:01,889 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 11064) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 22:01:02,399 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 22:01:02,941 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 22:01:02,942 | INFO | root | ================================================================================
2025-12-16 22:01:02,943 | INFO | root | 发送统一邮件
2025-12-16 22:01:02,943 | INFO | root | ================================================================================
2025-12-16 22:01:02,956 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 22:01:02,956 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 22:01:03,014 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 22:01:03,027 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 22:01:03,032 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 22:01:03,033 | INFO | root | PHI 数据前5行:
2025-12-16 22:01:03,034 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 22:01:03,035 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 22:01:03,035 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 22:01:03,035 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 22:01:03,036 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 22:01:03,036 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 22:01:03,056 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,057 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,058 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,058 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,058 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 22:01:03,059 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,061 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,061 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,061 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,062 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,065 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,065 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,066 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,066 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,068 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,068 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,068 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,068 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,088 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,089 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,089 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,089 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,091 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,092 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,092 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,092 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,094 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 22:01:03,095 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,095 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,095 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,098 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 22:01:03,099 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,099 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,099 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,117 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,117 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,118 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,118 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,120 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,120 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,120 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,121 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,122 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 22:01:03,123 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,123 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,123 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,125 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 22:01:03,125 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,125 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,128 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,149 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,149 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,150 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,150 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,151 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 22:01:03,152 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,152 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,152 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,154 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 22:01:03,154 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,155 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,155 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:03,156 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 22:01:03,158 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 22:01:03,158 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 22:01:03,158 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 22:01:05,945 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 22:01:06,003 | INFO | root | ================================================================================
2025-12-16 22:01:06,010 | INFO | root | ✅ 统一自动化完成
2025-12-16 22:01:06,010 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 22:01:06,012 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 22:01:06,012 | INFO | root | ================================================================================
2025-12-16 22:03:59,210 | INFO | root | ================================================================================
2025-12-16 22:03:59,210 | INFO | root | 统一自动化开始
2025-12-16 22:03:59,210 | INFO | root | ================================================================================
2025-12-16 22:03:59,210 | INFO | root | ================================================================================
2025-12-16 22:03:59,210 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 22:03:59,210 | INFO | root | ================================================================================
2025-12-16 22:03:59,226 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 22:03:59,226 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 22:03:59,226 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 22:03:59,226 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 22:03:59,226 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 22:03:59,226 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 22:03:59,320 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 22:04:00,351 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 22:04:05,693 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 22:04:05,693 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 17225) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 22:04:05,693 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 22:04:05,693 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 22:04:05,693 | WARNING | prd_lot_automation.spf_runner | 设置窗口焦点失败: There is no active desktop required for moving mouse cursor!

2025-12-16 22:04:06,703 | ERROR | root | ❌ 统一自动化失败: F8 发送失败: PyAutoGUI fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set pyautogui.FAILSAFE to False. DISABLING FAIL-SAFE IS NOT RECOMMENDED.
2025-12-16 22:04:06,709 | ERROR | root | Traceback (most recent call last):
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\mouse.py", line 59, in _set_cursor_pos
    win32api.SetCursorPos(coords)
pywintypes.error: (0, 'SetCursorPos', 'No error message is available')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\prd_lot_automation\spf_runner.py", line 498, in _click_run_button
    self._window.type_keys("{F8}")
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\base_wrapper.py", line 944, in type_keys
    self.set_focus()
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\controls\hwndwrapper.py", line 1309, in set_focus
    mouse.move(coords=(-10000, 500))  # move the mouse out of screen to the left
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\mouse.py", line 244, in move
    _perform_click_input(button='move',coords=coords,button_down=False,button_up=False)
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\mouse.py", line 137, in _perform_click_input
    _set_cursor_pos((coords[0], coords[1]))
  File "C:\ProgramData\miniforge3\Lib\site-packages\pywinauto\mouse.py", line 62, in _set_cursor_pos
    raise RuntimeError("There is no active desktop required for moving mouse cursor!\n")
RuntimeError: There is no active desktop required for moving mouse cursor!


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\prd_lot_automation\spf_runner.py", line 503, in _click_run_button
    pyautogui.press('f8')
  File "C:\ProgramData\miniforge3\Lib\site-packages\pyautogui\__init__.py", line 593, in wrapper
    failSafeCheck()
  File "C:\ProgramData\miniforge3\Lib\site-packages\pyautogui\__init__.py", line 1734, in failSafeCheck
    raise FailSafeException(
pyautogui.FailSafeException: PyAutoGUI fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set pyautogui.FAILSAFE to False. DISABLING FAIL-SAFE IS NOT RECOMMENDED.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\unified_automation.py", line 840, in main
    lab_report, lab_df = run_lab_tp_automation(lab_config_path)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\unified_automation.py", line 135, in run_lab_tp_automation
    runner.execute(lots)
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\prd_lot_automation\spf_runner.py", line 739, in execute
    self._click_run_button()
  File "C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\prd_lot_automation\spf_runner.py", line 506, in _click_run_button
    raise RuntimeError(f"F8 发送失败: {e2}")
RuntimeError: F8 发送失败: PyAutoGUI fail-safe triggered from mouse moving to a corner of the screen. To disable this fail-safe, set pyautogui.FAILSAFE to False. DISABLING FAIL-SAFE IS NOT RECOMMENDED.

2025-12-16 23:16:24,440 | INFO | root | ================================================================================
2025-12-16 23:16:24,440 | INFO | root | 统一自动化开始
2025-12-16 23:16:24,440 | INFO | root | ================================================================================
2025-12-16 23:16:24,440 | INFO | root | ================================================================================
2025-12-16 23:16:24,440 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 23:16:24,440 | INFO | root | ================================================================================
2025-12-16 23:16:24,456 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:16:24,456 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:16:24,456 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:16:24,456 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:16:24,456 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:16:24,456 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:16:24,565 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:16:25,581 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 23:16:30,874 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:16:30,874 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 8122) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:16:30,874 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:16:30,874 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:16:32,193 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:16:34,701 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:16:34,701 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:16:36,702 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:16:36,702 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:16:36,722 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:16:36,722 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:16:36,722 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:16:37,081 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:16:38,220 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:16:38,846 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:16:38,847 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:16:38,879 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (8122)
2025-12-16 23:16:38,895 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 23:16:38,911 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:16:38,974 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:16:39,022 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:16:39,038 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:16:39,054 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:16:39,086 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:16:39,086 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:16:39,149 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 23:16:41,195 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 23:16:45,199 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-16 23:16:49,205 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:16:49,205 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:16:49,205 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 23:16:49,205 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-16 23:16:49,205 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:16:49,205 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:16:49,215 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 23:16:49,215 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 23:16:49,231 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 23:16:49,231 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:16:49,310 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:16:49,310 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:16:49,310 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:16:49,310 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:16:49,310 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (8122)
2025-12-16 23:16:49,724 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:16:50,234 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 8122) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:16:50,676 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:16:51,222 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:16:51,222 | INFO | root | ================================================================================
2025-12-16 23:16:51,222 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 23:16:51,222 | INFO | root | ================================================================================
2025-12-16 23:16:51,238 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:16:51,238 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:16:51,238 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:16:51,238 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:16:53,250 | INFO | root | ================================================================================
2025-12-16 23:16:53,250 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 23:16:53,250 | INFO | root | ================================================================================
2025-12-16 23:16:53,264 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:16:53,269 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 23:16:53,269 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:16:53,269 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:16:53,269 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:16:53,269 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:16:53,269 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:16:53,280 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:16:54,285 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 23:16:59,469 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:16:59,469 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 24741) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:16:59,469 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:16:59,469 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:17:00,796 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:17:03,304 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:17:03,304 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:17:05,306 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:17:05,306 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:17:05,315 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:17:05,315 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:17:05,332 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:17:05,709 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:17:06,877 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:17:07,448 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:17:07,448 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:17:17,472 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 23:17:19,473 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 23:17:19,489 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 23:17:19,489 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:17:19,489 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:17:19,865 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 23:17:20,987 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 23:17:21,606 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:17:21,622 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 23:17:21,622 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 23:17:23,648 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 23:17:28,701 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 23:17:33,754 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 23:17:38,806 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 23:17:43,858 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 23:17:48,908 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 23:17:53,959 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:17:53,959 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:18:01,965 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 23:18:11,974 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 23:18:21,978 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 23:18:31,981 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 23:18:41,984 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 23:18:51,988 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 23:19:01,991 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 23:19:03,993 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-16 23:19:07,998 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 23:19:12,001 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:19:12,001 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:19:12,001 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 23:19:12,001 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 23:19:12,001 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:19:12,001 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:19:12,042 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-16 23:19:12,042 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 23:19:12,042 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 4527 行过滤到 1509 行
2025-12-16 23:19:12,042 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 1509 行
2025-12-16 23:19:12,042 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 1509
2025-12-16 23:19:12,058 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 1509
2025-12-16 23:19:12,058 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:19:12,058 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (80, 3)
2025-12-16 23:19:12,074 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 1509
2025-12-16 23:19:12,074 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:19:12,074 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (26, 3)
2025-12-16 23:19:12,090 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 23:19:12,090 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 23:19:12,090 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 1548 行过滤到 516 行
2025-12-16 23:19:12,090 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 516 行
2025-12-16 23:19:12,090 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 516
2025-12-16 23:19:12,090 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:19:12,090 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (79, 3)
2025-12-16 23:19:12,105 | INFO | root | Retest Bin Pareto 生成完成
2025-12-16 23:19:12,105 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:19:13,836 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:19:13,836 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:19:13,852 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:19:13,852 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:19:13,852 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (24741)
2025-12-16 23:19:14,262 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:19:14,774 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 24741) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:19:15,212 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:19:15,830 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:19:15,831 | INFO | root | ================================================================================
2025-12-16 23:19:15,831 | INFO | root | 发送统一邮件
2025-12-16 23:19:15,831 | INFO | root | ================================================================================
2025-12-16 23:19:15,847 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:19:15,847 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 23:19:15,879 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 23:19:15,879 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 23:19:15,894 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 23:19:15,894 | INFO | root | PHI 数据前5行:
2025-12-16 23:19:15,894 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:19:15,894 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:19:15,894 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:19:15,894 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:19:15,894 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 23:19:15,894 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 23:19:15,910 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,926 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,930 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,930 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,930 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 23:19:15,930 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,930 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,961 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,961 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,961 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,974 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,974 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,974 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,974 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,974 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,974 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,974 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 23:19:15,989 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,989 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,989 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,993 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,993 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:15,993 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:15,993 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:15,993 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:19:15,993 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:16,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:16,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:16,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:16,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:16,006 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,006 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:16,021 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 23:19:16,021 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:19:16,021 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:19:16,021 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:19:21,883 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 23:19:21,930 | INFO | root | ================================================================================
2025-12-16 23:19:21,961 | INFO | root | ✅ 统一自动化完成
2025-12-16 23:19:22,024 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:19:22,102 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:19:22,118 | INFO | root | ================================================================================
2025-12-16 23:31:22,292 | INFO | root | ================================================================================
2025-12-16 23:31:22,292 | INFO | root | 统一自动化开始
2025-12-16 23:31:22,292 | INFO | root | ================================================================================
2025-12-16 23:31:22,292 | INFO | root | ================================================================================
2025-12-16 23:31:22,292 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 23:31:22,292 | INFO | root | ================================================================================
2025-12-16 23:31:22,308 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:31:22,308 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:31:22,308 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:31:22,308 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:31:22,308 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:31:22,308 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:31:22,417 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:31:23,511 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 23:31:28,870 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:31:28,870 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 1335) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:31:28,870 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:31:28,870 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:31:30,190 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:31:32,696 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:31:32,696 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:31:34,698 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:31:34,698 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:31:34,715 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:31:34,715 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:31:34,715 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:31:35,074 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:31:36,201 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:31:36,854 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:31:36,866 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:31:36,866 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (1335)
2025-12-16 23:31:36,866 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 23:31:36,882 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:31:36,886 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:31:36,886 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:31:36,886 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:31:36,898 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:31:36,898 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:31:36,898 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:31:36,898 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 23:31:38,906 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 23:31:42,911 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-16 23:31:46,915 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:31:46,915 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:31:46,915 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 23:31:46,915 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-16 23:31:46,915 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:31:46,918 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:31:46,918 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 23:31:46,918 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 23:31:46,934 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 23:31:46,934 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:31:46,997 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:31:46,997 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:31:46,997 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:31:46,997 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:31:46,997 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (1335)
2025-12-16 23:31:47,408 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:31:47,918 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 1335) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:31:48,324 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:31:48,904 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:31:48,904 | INFO | root | ================================================================================
2025-12-16 23:31:48,904 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 23:31:48,904 | INFO | root | ================================================================================
2025-12-16 23:31:48,904 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:31:48,904 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:31:48,904 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:31:48,917 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:31:50,933 | INFO | root | ================================================================================
2025-12-16 23:31:50,934 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 23:31:50,934 | INFO | root | ================================================================================
2025-12-16 23:31:50,949 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:31:50,949 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 23:31:50,949 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:31:50,949 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:31:50,949 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:31:50,949 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:31:50,949 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:31:50,965 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:31:51,980 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 23:31:57,167 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:31:57,167 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 17515) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:31:57,167 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:31:57,167 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:31:58,485 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:32:00,993 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:32:00,993 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:32:02,994 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:32:02,994 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:32:03,011 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:32:03,024 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:32:03,024 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:32:03,405 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:32:04,701 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:32:05,298 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:32:05,313 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:32:15,358 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 23:32:17,359 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 23:32:17,372 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 23:32:17,372 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:32:17,372 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:32:17,729 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 23:32:18,906 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 23:32:19,536 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:32:19,543 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 23:32:19,543 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 23:32:21,562 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 23:32:26,663 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 23:32:31,717 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 23:32:36,770 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 23:32:41,822 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 23:32:46,873 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 23:32:51,922 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:32:51,922 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:32:59,926 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 23:33:09,929 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 23:33:19,933 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 23:33:29,937 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 23:33:39,940 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 23:33:49,945 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 23:33:59,949 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 23:34:01,951 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-16 23:34:05,961 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 23:34:09,963 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:34:09,963 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:34:09,963 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 23:34:09,963 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 23:34:09,963 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:34:09,966 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:34:10,030 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-16 23:34:10,061 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 23:34:10,077 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 4527 行过滤到 1509 行
2025-12-16 23:34:10,077 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 1509 行
2025-12-16 23:34:10,077 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 1509
2025-12-16 23:34:10,077 | INFO | prd_lot_automation.data_processing | process_step 列已处理，唯一值: ['CLASSHOT', 'CSM']
2025-12-16 23:34:10,077 | INFO | root | 找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-16 23:34:10,092 | INFO | root | 处理 process_step: CLASSHOT，数据行数: 1187
2025-12-16 23:34:10,092 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 1187
2025-12-16 23:34:10,092 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:34:10,092 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-16 23:34:10,092 | INFO | root | ✅ CLASSHOT 的 Functional_bin Pareto 生成完成
2025-12-16 23:34:10,092 | INFO | root | 处理 process_step: CSM，数据行数: 322
2025-12-16 23:34:10,108 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 322
2025-12-16 23:34:10,108 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:34:10,108 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (22, 3)
2025-12-16 23:34:10,124 | INFO | root | ✅ CSM 的 Functional_bin Pareto 生成完成
2025-12-16 23:34:10,124 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 1509
2025-12-16 23:34:10,124 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:34:10,124 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (26, 3)
2025-12-16 23:34:10,124 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 23:34:10,124 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 23:34:10,139 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 1548 行过滤到 516 行
2025-12-16 23:34:10,139 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 516 行
2025-12-16 23:34:10,139 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 516
2025-12-16 23:34:10,139 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:34:10,155 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (79, 3)
2025-12-16 23:34:10,155 | INFO | root | Retest Bin Pareto 生成完成
2025-12-16 23:34:10,155 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:34:10,249 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Pareto 表
2025-12-16 23:34:10,342 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Pareto 表
2025-12-16 23:34:10,389 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Pareto 表
2025-12-16 23:34:12,061 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:34:12,061 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:34:12,061 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:34:12,061 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:34:12,061 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (17515)
2025-12-16 23:34:12,476 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:34:12,977 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 17515) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:34:13,542 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:34:14,139 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:34:14,139 | INFO | root | ================================================================================
2025-12-16 23:34:14,139 | INFO | root | 发送统一邮件
2025-12-16 23:34:14,145 | INFO | root | ================================================================================
2025-12-16 23:34:14,145 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:34:14,145 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 23:34:14,192 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 23:34:14,192 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 23:34:14,192 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 23:34:14,192 | INFO | root | PHI 数据前5行:
2025-12-16 23:34:14,192 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:34:14,192 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:34:14,192 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:34:14,192 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:34:14,192 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 23:34:14,192 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 23:34:14,208 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,208 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 23:34:14,208 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,208 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,208 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,208 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,224 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,224 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,224 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,224 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,240 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,240 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,240 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,240 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,240 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,240 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,240 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,256 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,256 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,256 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,256 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,256 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:34:14,256 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,256 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,256 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,256 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 23:34:14,272 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,272 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,272 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:14,272 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 23:34:14,272 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:34:14,272 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:34:14,272 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:34:17,311 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 23:34:17,358 | INFO | root | ================================================================================
2025-12-16 23:34:17,358 | INFO | root | ✅ 统一自动化完成
2025-12-16 23:34:17,358 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:34:17,358 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:34:17,358 | INFO | root | ================================================================================
2025-12-16 23:40:41,412 | INFO | root | ================================================================================
2025-12-16 23:40:41,412 | INFO | root | 统一自动化开始
2025-12-16 23:40:41,412 | INFO | root | ================================================================================
2025-12-16 23:40:41,412 | INFO | root | ================================================================================
2025-12-16 23:40:41,412 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 23:40:41,412 | INFO | root | ================================================================================
2025-12-16 23:40:41,428 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:40:41,428 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:40:41,428 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:40:41,428 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:40:41,428 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:40:41,428 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:40:41,521 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:40:42,553 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 23:40:47,860 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:40:47,860 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 26737) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:40:47,860 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:40:47,860 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:40:49,179 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:40:51,750 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:40:51,750 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:40:53,752 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:40:53,752 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:40:53,772 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:40:53,772 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:40:53,784 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:40:54,145 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:40:55,342 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:40:56,013 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:40:56,037 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:40:56,053 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (26737)
2025-12-16 23:40:56,084 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:40:56,099 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 23:40:58,105 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 23:41:02,116 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-16 23:41:06,122 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:41:06,122 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:41:06,122 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 23:41:06,122 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-16 23:41:06,122 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:41:06,131 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:41:06,131 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 23:41:06,131 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 23:41:06,147 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 23:41:06,147 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:41:06,209 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:41:06,225 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:41:06,240 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:41:06,240 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:41:06,240 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (26737)
2025-12-16 23:41:06,652 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:41:07,152 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 26737) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:41:07,631 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:41:08,224 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:41:08,224 | INFO | root | ================================================================================
2025-12-16 23:41:08,225 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 23:41:08,225 | INFO | root | ================================================================================
2025-12-16 23:41:08,225 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:41:08,225 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:41:08,225 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:41:08,241 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:41:10,251 | INFO | root | ================================================================================
2025-12-16 23:41:10,251 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 23:41:10,251 | INFO | root | ================================================================================
2025-12-16 23:41:10,256 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:41:10,256 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 23:41:10,256 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:41:10,256 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:41:10,256 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:41:10,256 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:41:10,256 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:41:10,273 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:41:11,288 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 23:41:17,143 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:41:17,155 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 20846) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:41:17,159 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:41:17,159 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:41:18,846 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:41:21,359 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:41:21,366 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:41:23,377 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:41:23,377 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:41:23,397 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:41:23,397 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:41:23,412 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:41:23,774 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:41:24,991 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:41:25,517 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:41:25,517 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:41:35,552 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 23:41:37,553 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 23:41:37,570 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 23:41:37,570 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:41:37,570 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:41:37,962 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 23:41:39,310 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 23:41:39,886 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:41:39,886 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 23:41:39,913 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 23:41:41,925 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 23:41:47,007 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 23:41:52,047 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 23:41:57,088 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 23:42:02,125 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 23:42:07,162 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 23:42:12,200 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:42:12,200 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:42:20,205 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 23:42:30,210 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 23:42:40,217 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 23:42:50,220 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 23:43:00,223 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 23:43:10,227 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 23:43:20,230 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 23:43:24,232 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 72 秒)
2025-12-16 23:43:26,237 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 1/4)
2025-12-16 23:43:30,239 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 78 秒，稳定检查: 3/4)
2025-12-16 23:43:32,240 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:43:32,240 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:43:32,240 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 23:43:32,240 | INFO | prd_lot_automation.spf_runner |    等待时间: 80 秒
2025-12-16 23:43:32,240 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:43:32,243 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:43:32,291 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-16 23:43:32,307 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 23:43:32,307 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 4527 行过滤到 1509 行
2025-12-16 23:43:32,307 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 1509 行
2025-12-16 23:43:32,307 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 1509
2025-12-16 23:43:32,307 | INFO | prd_lot_automation.data_processing | process_step 列已处理，唯一值: ['CLASSHOT', 'CSM']
2025-12-16 23:43:32,307 | INFO | root | 找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-16 23:43:32,322 | INFO | root | 处理 process_step: CLASSHOT，数据行数: 1187
2025-12-16 23:43:32,322 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 1187
2025-12-16 23:43:32,322 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:43:32,322 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-16 23:43:32,339 | INFO | root | ✅ CLASSHOT 的 Functional_bin Pareto 生成完成
2025-12-16 23:43:32,339 | INFO | root | 处理 process_step: CSM，数据行数: 322
2025-12-16 23:43:32,339 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 322
2025-12-16 23:43:32,339 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:43:32,339 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (22, 3)
2025-12-16 23:43:32,354 | INFO | root | ✅ CSM 的 Functional_bin Pareto 生成完成
2025-12-16 23:43:32,354 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 1187
2025-12-16 23:43:32,354 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:43:32,354 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (26, 3)
2025-12-16 23:43:32,370 | INFO | root | ✅ CLASSHOT 的 Interface_bin Pareto 生成完成
2025-12-16 23:43:32,370 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 322
2025-12-16 23:43:32,370 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:43:32,370 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (11, 3)
2025-12-16 23:43:32,370 | INFO | root | ✅ CSM 的 Interface_bin Pareto 生成完成
2025-12-16 23:43:32,370 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 23:43:32,386 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 23:43:32,386 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 1548 行过滤到 516 行
2025-12-16 23:43:32,386 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 516 行
2025-12-16 23:43:32,386 | INFO | root | Retest 数据中找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-16 23:43:32,386 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 325
2025-12-16 23:43:32,386 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:43:32,386 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-16 23:43:32,402 | INFO | root | ✅ CLASSHOT 的 Retest Bin Pareto 生成完成
2025-12-16 23:43:32,402 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 191
2025-12-16 23:43:32,402 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:43:32,402 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (23, 3)
2025-12-16 23:43:32,418 | INFO | root | ✅ CSM 的 Retest Bin Pareto 生成完成
2025-12-16 23:43:32,418 | INFO | root | Retest Bin Pareto 生成完成
2025-12-16 23:43:32,418 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:43:32,513 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Functional_bin Pareto 表
2025-12-16 23:43:32,640 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Functional_bin Pareto 表
2025-12-16 23:43:32,688 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Functional_bin Pareto 表
2025-12-16 23:43:32,743 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Interface_bin Pareto 表
2025-12-16 23:43:32,783 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Interface_bin Pareto 表
2025-12-16 23:43:32,831 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Interface_bin Pareto 表
2025-12-16 23:43:32,926 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Retest Bin Pareto 表
2025-12-16 23:43:33,024 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Retest Bin Pareto 表
2025-12-16 23:43:33,069 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Retest Bin Pareto 表
2025-12-16 23:43:34,649 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:43:34,649 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:43:34,649 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:43:34,649 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:43:34,665 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (20846)
2025-12-16 23:43:35,071 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:43:35,575 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 20846) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:43:36,165 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:43:36,690 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:43:36,690 | INFO | root | ================================================================================
2025-12-16 23:43:36,696 | INFO | root | 发送统一邮件
2025-12-16 23:43:36,696 | INFO | root | ================================================================================
2025-12-16 23:43:36,712 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:43:36,712 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 23:43:36,743 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 23:43:36,743 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 23:43:36,743 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 23:43:36,743 | INFO | root | PHI 数据前5行:
2025-12-16 23:43:36,743 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:43:36,743 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:43:36,743 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:43:36,743 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:43:36,743 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 23:43:36,743 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 23:43:36,759 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,759 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,759 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,759 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,759 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 23:43:36,759 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,759 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,759 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,759 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,759 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,774 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,774 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,774 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,774 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,790 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,790 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,790 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,790 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,790 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,790 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,790 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,805 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,805 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,805 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:43:36,805 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,821 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:36,821 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:43:36,821 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:43:39,564 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 23:43:39,649 | INFO | root | ================================================================================
2025-12-16 23:43:39,649 | INFO | root | ✅ 统一自动化完成
2025-12-16 23:43:39,660 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:43:39,680 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:43:39,739 | INFO | root | ================================================================================
2025-12-16 23:51:08,530 | INFO | root | ================================================================================
2025-12-16 23:51:08,530 | INFO | root | 统一自动化开始
2025-12-16 23:51:08,530 | INFO | root | ================================================================================
2025-12-16 23:51:08,530 | INFO | root | ================================================================================
2025-12-16 23:51:08,530 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-16 23:51:08,530 | INFO | root | ================================================================================
2025-12-16 23:51:08,546 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:51:08,546 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:51:08,546 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:51:08,546 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:51:08,546 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:51:08,546 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:51:08,640 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:51:09,656 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-16 23:51:15,283 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:51:15,283 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 18013) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:51:15,283 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:51:15,283 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:51:16,603 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:51:19,110 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:51:19,110 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:51:21,112 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:51:21,112 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:51:21,124 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:51:21,140 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:51:21,140 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:51:21,535 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:51:22,768 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:51:23,439 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:51:23,439 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:51:23,468 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (18013)
2025-12-16 23:51:23,482 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-16 23:51:23,499 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:51:23,514 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:51:23,561 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:51:23,593 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:51:23,593 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:51:23,593 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:51:23,608 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:51:23,655 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-16 23:51:25,676 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-16 23:51:29,689 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 2/4)
2025-12-16 23:51:33,693 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:51:33,693 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:51:33,693 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-16 23:51:33,693 | INFO | prd_lot_automation.spf_runner |    等待时间: 10 秒
2025-12-16 23:51:33,693 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:51:33,693 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-16 23:51:33,699 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-16 23:51:33,699 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-16 23:51:33,718 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-16 23:51:33,718 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:51:33,794 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:51:33,794 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:51:33,794 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:51:33,794 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:51:33,794 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (18013)
2025-12-16 23:51:34,208 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:51:34,718 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 18013) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-16 23:51:35,126 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:51:35,710 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:51:35,710 | INFO | root | ================================================================================
2025-12-16 23:51:35,710 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-16 23:51:35,710 | INFO | root | ================================================================================
2025-12-16 23:51:35,710 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:51:35,714 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:51:35,718 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:51:35,730 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:51:37,735 | INFO | root | ================================================================================
2025-12-16 23:51:37,735 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-16 23:51:37,735 | INFO | root | ================================================================================
2025-12-16 23:51:37,749 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:51:37,749 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-16 23:51:37,765 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-16 23:51:37,765 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-16 23:51:37,765 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:51:37,765 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-16 23:51:37,765 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-16 23:51:37,765 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-16 23:51:38,781 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-16 23:51:43,958 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-16 23:51:43,958 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 16590) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:51:43,958 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-16 23:51:43,958 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-16 23:51:45,289 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-16 23:51:47,792 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-16 23:51:47,792 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-16 23:51:49,793 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-16 23:51:49,793 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-16 23:51:49,812 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-16 23:51:49,820 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:51:49,820 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:51:50,189 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-16 23:51:51,393 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-16 23:51:51,970 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:51:51,970 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-16 23:52:01,998 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-16 23:52:03,999 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-16 23:52:04,016 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-16 23:52:04,016 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-16 23:52:04,031 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-16 23:52:04,407 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-16 23:52:05,549 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-16 23:52:06,188 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-16 23:52:06,188 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-16 23:52:06,218 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-16 23:52:08,234 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-16 23:52:13,312 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-16 23:52:18,368 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-16 23:52:23,419 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-16 23:52:28,473 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-16 23:52:33,523 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-16 23:52:38,599 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-16 23:52:38,599 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:52:46,628 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-16 23:52:56,631 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-16 23:53:06,634 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-16 23:53:16,638 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-16 23:53:26,641 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-16 23:53:36,644 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-16 23:53:46,647 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-16 23:53:48,648 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-16 23:53:52,653 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-16 23:53:56,656 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:53:56,656 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:53:56,656 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-16 23:53:56,656 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-16 23:53:56,656 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-16 23:53:56,656 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-16 23:53:56,702 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-16 23:53:56,702 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-16 23:53:56,702 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 4527 行过滤到 1509 行
2025-12-16 23:53:56,702 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 1509 行
2025-12-16 23:53:56,702 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 1509
2025-12-16 23:53:56,720 | INFO | prd_lot_automation.data_processing | process_step 列已处理，唯一值: ['CLASSHOT', 'CSM']
2025-12-16 23:53:56,720 | INFO | root | 找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-16 23:53:56,720 | INFO | root | 处理 process_step: CLASSHOT，数据行数: 1187
2025-12-16 23:53:56,720 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 1187
2025-12-16 23:53:56,720 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:53:56,734 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-16 23:53:56,734 | INFO | root | ✅ CLASSHOT 的 Functional_bin Pareto 生成完成
2025-12-16 23:53:56,734 | INFO | root | 处理 process_step: CSM，数据行数: 322
2025-12-16 23:53:56,734 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 322
2025-12-16 23:53:56,734 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:53:56,734 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (22, 3)
2025-12-16 23:53:56,751 | INFO | root | ✅ CSM 的 Functional_bin Pareto 生成完成
2025-12-16 23:53:56,751 | INFO | root | 已按 process_step 分组，不生成总的 Functional_bin Pareto 表
2025-12-16 23:53:56,751 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 1187
2025-12-16 23:53:56,751 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:53:56,751 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (26, 3)
2025-12-16 23:53:56,766 | INFO | root | ✅ CLASSHOT 的 Interface_bin Pareto 生成完成
2025-12-16 23:53:56,766 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 322
2025-12-16 23:53:56,766 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:53:56,766 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (11, 3)
2025-12-16 23:53:56,766 | INFO | root | ✅ CSM 的 Interface_bin Pareto 生成完成
2025-12-16 23:53:56,766 | INFO | root | 已按 process_step 分组，不生成总的 Interface_bin Pareto 表
2025-12-16 23:53:56,782 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-16 23:53:56,782 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-16 23:53:56,782 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 1548 行过滤到 516 行
2025-12-16 23:53:56,782 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 516 行
2025-12-16 23:53:56,782 | INFO | root | Retest 数据中找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-16 23:53:56,782 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 325
2025-12-16 23:53:56,782 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:53:56,798 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-16 23:53:56,798 | INFO | root | ✅ CLASSHOT 的 Retest Bin Pareto 生成完成
2025-12-16 23:53:56,798 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 191
2025-12-16 23:53:56,798 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-16 23:53:56,798 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (23, 3)
2025-12-16 23:53:56,798 | INFO | root | ✅ CSM 的 Retest Bin Pareto 生成完成
2025-12-16 23:53:56,798 | INFO | root | 已按 process_step 分组，不生成总的 Retest Bin Pareto 表
2025-12-16 23:53:56,798 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:53:56,829 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Functional_bin Pareto 表
2025-12-16 23:53:56,933 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Functional_bin Pareto 表
2025-12-16 23:53:56,987 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Functional_bin Pareto 表
2025-12-16 23:53:56,989 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Interface_bin Pareto 表
2025-12-16 23:53:57,044 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Interface_bin Pareto 表
2025-12-16 23:53:57,082 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Interface_bin Pareto 表
2025-12-16 23:53:57,082 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Retest Bin Pareto 表
2025-12-16 23:53:57,173 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Retest Bin Pareto 表
2025-12-16 23:53:57,220 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Retest Bin Pareto 表
2025-12-16 23:53:58,737 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:53:58,737 | INFO | root | 关闭 SQLPathFinder...
2025-12-16 23:53:58,737 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-16 23:53:58,737 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-16 23:53:58,737 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (16590)
2025-12-16 23:53:59,153 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:53:59,656 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 16590) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-16 23:54:00,314 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-16 23:54:00,834 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-16 23:54:00,845 | INFO | root | ================================================================================
2025-12-16 23:54:00,845 | INFO | root | 发送统一邮件
2025-12-16 23:54:00,845 | INFO | root | ================================================================================
2025-12-16 23:54:00,860 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-16 23:54:00,860 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-16 23:54:00,891 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-16 23:54:00,891 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-16 23:54:00,891 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-16 23:54:00,891 | INFO | root | PHI 数据前5行:
2025-12-16 23:54:00,891 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:54:00,891 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:54:00,891 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:54:00,891 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-16 23:54:00,891 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-16 23:54:00,891 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-16 23:54:00,907 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,907 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,907 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,907 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,907 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-16 23:54:00,907 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,907 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,907 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,907 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,907 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,923 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,923 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,923 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,923 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,923 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,923 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,923 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,938 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,938 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,938 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,954 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,954 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,954 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,954 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,954 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,970 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:00,970 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-16 23:54:00,970 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-16 23:54:03,907 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-16 23:54:04,032 | INFO | root | ================================================================================
2025-12-16 23:54:04,048 | INFO | root | ✅ 统一自动化完成
2025-12-16 23:54:04,095 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251216.xlsx
2025-12-16 23:54:04,141 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-16.xlsx
2025-12-16 23:54:04,141 | INFO | root | ================================================================================
2025-12-17 00:52:03,851 | INFO | root | ================================================================================
2025-12-17 00:52:03,867 | INFO | root | 统一自动化开始
2025-12-17 00:52:03,867 | INFO | root | ================================================================================
2025-12-17 00:52:03,867 | INFO | root | ================================================================================
2025-12-17 00:52:03,867 | INFO | root | 开始执行 Lab TP Performance 自动化
2025-12-17 00:52:03,867 | INFO | root | ================================================================================
2025-12-17 00:52:03,883 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-17 00:52:03,898 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-17 00:52:03,898 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-17 00:52:03,898 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-17 00:52:03,898 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-17 00:52:03,898 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-17 00:52:04,008 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-17 00:52:05,054 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lab_Class_Data_Performance.VG2
2025-12-17 00:52:10,639 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-17 00:52:10,639 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 1156) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-17 00:52:10,639 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-17 00:52:10,639 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-17 00:52:11,963 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-17 00:52:14,469 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-17 00:52:14,469 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-17 00:52:16,470 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-17 00:52:16,473 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-17 00:52:16,492 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-17 00:52:16,492 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-17 00:52:16,505 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-17 00:52:16,871 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-17 00:52:18,181 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-17 00:52:18,784 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-17 00:52:18,816 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-17 00:52:18,831 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 Query Log 窗口: SQLPathFinder Query Log (1156)
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | ✅ Query Log 窗口已出现，查询正在执行中
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:52:18,848 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,649 字节，已等待 0 秒)
2025-12-17 00:52:20,867 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 2 秒，稳定检查: 1/4)
2025-12-17 00:52:24,878 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 6 秒，稳定检查: 3/4)
2025-12-17 00:52:26,884 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:52:26,884 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-17 00:52:26,891 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,649 字节
2025-12-17 00:52:26,891 | INFO | prd_lot_automation.spf_runner |    等待时间: 8 秒
2025-12-17 00:52:26,891 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:52:26,891 | INFO | lab_tp_automation.lab_tp_main | 读取 Lab TP 数据：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\Lot_Level_Data.csv
2025-12-17 00:52:26,914 | INFO | lab_tp_automation.lab_tp_main | 数据集形状: (16, 13)
2025-12-17 00:52:26,914 | INFO | lab_tp_automation.lab_tp_main | 列名映射: {'OPERATION': 'Operation', 'DEVREVSTEP': 'Devrevstep', 'PROGRAM_NAME': 'Program Name', 'SUB_FLOW_STEP': 'Sub Flow Step', 'FACILITY': 'Facility', 'TOTAL_TESTED': 'Total Tested', 'TESTE_GOOD': 'Tested Good', 'YIELD': 'Yield', 'TTG': 'TTG', 'ETT': 'ETT', 'RCS': 'RCS', 'RECOVERY_RATE': 'Recovery Rate'}
2025-12-17 00:52:26,914 | INFO | lab_tp_automation.lab_tp_main | 处理后数据形状: (16, 12)
2025-12-17 00:52:26,930 | INFO | lab_tp_automation.lab_tp_main | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251217.xlsx
2025-12-17 00:52:26,992 | INFO | root | ✅ Lab TP Performance 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251217.xlsx
2025-12-17 00:52:27,008 | INFO | root | 关闭 SQLPathFinder...
2025-12-17 00:52:27,008 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-17 00:52:27,008 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-17 00:52:27,008 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (1156)
2025-12-17 00:52:27,423 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-17 00:52:27,940 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Pre/Post Query -  -  - 1156) - [Lab_Class_Data_Performance.VG2 (L0)]
2025-12-17 00:52:28,439 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-17 00:52:28,967 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-17 00:52:28,967 | INFO | root | ================================================================================
2025-12-17 00:52:28,967 | INFO | root | 准备执行下一个 VG2，先关闭所有 SQLPathFinder 窗口
2025-12-17 00:52:28,967 | INFO | root | ================================================================================
2025-12-17 00:52:28,967 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-17 00:52:28,967 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-17 00:52:28,967 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-17 00:52:28,977 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-17 00:52:30,981 | INFO | root | ================================================================================
2025-12-17 00:52:30,981 | INFO | root | 开始执行 PRD LOT 自动化
2025-12-17 00:52:30,981 | INFO | root | ================================================================================
2025-12-17 00:52:30,993 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-17 00:52:30,993 | INFO | root | 执行批次 1/1，LOT 数：8
2025-12-17 00:52:30,993 | INFO | prd_lot_automation.spf_runner | 启动 SPF 运行，LOT 数：8
2025-12-17 00:52:30,993 | INFO | prd_lot_automation.spf_runner | 检查并关闭现有的 SQLPathFinder 窗口...
2025-12-17 00:52:30,993 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-17 00:52:30,993 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 0 个 SQLPathFinder 窗口
2025-12-17 00:52:31,009 | INFO | prd_lot_automation.close_sqlpathfinder | 尝试强制终止 SQLPathFinder 进程...
2025-12-17 00:52:31,009 | INFO | prd_lot_automation.close_sqlpathfinder | 未找到需要关闭的 SQLPathFinder 窗口
2025-12-17 00:52:32,023 | INFO | prd_lot_automation.spf_runner | 直接打开 VG2：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2
2025-12-17 00:52:37,198 | INFO | prd_lot_automation.spf_runner | 找到 14 个 SQLPathFinder 窗口
2025-12-17 00:52:37,198 | INFO | prd_lot_automation.spf_runner | ✅ 找到匹配的窗口: SQLPathFinder 3 (Main - 7189) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-17 00:52:37,198 | INFO | prd_lot_automation.spf_runner | 已连接到 SQLPathFinder 主窗口 (win32 backend)
2025-12-17 00:52:37,198 | INFO | prd_lot_automation.spf_runner | 使用 F8 快捷键触发 Run...
2025-12-17 00:52:38,522 | INFO | prd_lot_automation.spf_runner | ✅ 已发送 F8 快捷键
2025-12-17 00:52:41,030 | INFO | prd_lot_automation.spf_runner | 等待 LOT 输入弹窗：Prompt For Values
2025-12-17 00:52:41,030 | INFO | prd_lot_automation.spf_runner | 等待弹窗出现...
2025-12-17 00:52:43,031 | INFO | prd_lot_automation.spf_runner | 处理第一个参数弹窗...
2025-12-17 00:52:43,031 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #1...
2025-12-17 00:52:43,054 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #1: Prompt For Values (in)
2025-12-17 00:52:43,054 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-17 00:52:43,054 | INFO | prd_lot_automation.spf_runner | 弹窗 #1: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-17 00:52:43,430 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 Paste 按钮
2025-12-17 00:52:44,586 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: 已点击 OK 按钮
2025-12-17 00:52:45,204 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #1: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-17 00:52:45,204 | INFO | prd_lot_automation.spf_runner | 等待 Query Log 窗口出现（表明查询已开始执行）...
2025-12-17 00:52:55,229 | INFO | prd_lot_automation.spf_runner | 未检测到 Query Log 窗口，检查是否有第二个参数弹窗...
2025-12-17 00:52:57,231 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #2...
2025-12-17 00:52:57,246 | INFO | prd_lot_automation.spf_runner | ✅ 找到弹窗 #2: Prompt For Values (in)
2025-12-17 00:52:57,246 | INFO | prd_lot_automation.spf_runner |    使用模式: .*Prompt.*Values.*
2025-12-17 00:52:57,246 | INFO | prd_lot_automation.spf_runner | 弹窗 #2: LOT 列表已复制到剪贴板 (8 个，使用 win32clipboard)
2025-12-17 00:52:57,618 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 Paste 按钮
2025-12-17 00:52:58,766 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: 已点击 OK 按钮
2025-12-17 00:52:59,353 | INFO | prd_lot_automation.spf_runner | ✅ 弹窗 #2: LOT 已提交，SQLPathFinder 开始执行查询...
2025-12-17 00:52:59,364 | INFO | prd_lot_automation.spf_runner | ✅ 第二个参数弹窗已处理
2025-12-17 00:52:59,367 | INFO | prd_lot_automation.spf_runner | 检查是否有第三个参数弹窗...
2025-12-17 00:53:01,391 | INFO | prd_lot_automation.spf_runner | 第 1 次尝试查找弹窗 #3...
2025-12-17 00:53:06,446 | INFO | prd_lot_automation.spf_runner | 第 2 次尝试查找弹窗 #3...
2025-12-17 00:53:11,497 | INFO | prd_lot_automation.spf_runner | 第 3 次尝试查找弹窗 #3...
2025-12-17 00:53:16,549 | INFO | prd_lot_automation.spf_runner | 第 4 次尝试查找弹窗 #3...
2025-12-17 00:53:21,599 | INFO | prd_lot_automation.spf_runner | 第 5 次尝试查找弹窗 #3...
2025-12-17 00:53:26,650 | INFO | prd_lot_automation.spf_runner | 第 6 次尝试查找弹窗 #3...
2025-12-17 00:53:31,700 | WARNING | prd_lot_automation.spf_runner | ❌ 超时后仍未找到弹窗 #3
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | 没有第三个参数弹窗
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | ✅ 所有参数弹窗已处理完成，LOT 数：8
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | LOT 已下发给 SQLPathFinder，等待 by_lot.csv 更新
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | 开始等待 SQLPathFinder 查询完成...
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | 输出文件路径: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | 超时时间: 900 秒
2025-12-17 00:53:31,700 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:53:39,706 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 8 秒)
2025-12-17 00:53:49,709 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 18 秒)
2025-12-17 00:53:59,712 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 28 秒)
2025-12-17 00:54:09,715 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 38 秒)
2025-12-17 00:54:19,718 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 48 秒)
2025-12-17 00:54:29,721 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 58 秒)
2025-12-17 00:54:39,725 | INFO | prd_lot_automation.spf_runner | ⏳ 等待 CSV 文件生成... (已等待 68 秒)
2025-12-17 00:54:41,726 | INFO | prd_lot_automation.spf_runner | ✅ 检测到 CSV 文件已创建 (大小: 1,820,124 字节，已等待 70 秒)
2025-12-17 00:54:45,730 | INFO | prd_lot_automation.spf_runner | ⏳ 文件正在更新中... (已等待 74 秒，稳定检查: 2/4)
2025-12-17 00:54:49,732 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:54:49,732 | INFO | prd_lot_automation.spf_runner | ✅ CSV 文件已生成并稳定: C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-17 00:54:49,732 | INFO | prd_lot_automation.spf_runner |    文件大小: 1,820,124 字节
2025-12-17 00:54:49,732 | INFO | prd_lot_automation.spf_runner |    等待时间: 78 秒
2025-12-17 00:54:49,732 | INFO | prd_lot_automation.spf_runner | ============================================================
2025-12-17 00:54:49,732 | INFO | prd_lot_automation.data_processing | 读取抓取结果：C:\Users\qibaiche\AppData\Local\Temp\SQLPathFinder_Temp\by_lot.csv
2025-12-17 00:54:49,775 | INFO | prd_lot_automation.data_processing | 标准化前数据行数: 6075
2025-12-17 00:54:49,775 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = Y，从 6075 行过滤到 4527 行
2025-12-17 00:54:49,775 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 4527 行过滤到 1509 行
2025-12-17 00:54:49,791 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 1509 行
2025-12-17 00:54:49,791 | INFO | prd_lot_automation.data_processing | 应用过滤条件后数据行数: 1509
2025-12-17 00:54:49,791 | INFO | prd_lot_automation.data_processing | process_step 列已处理，唯一值: ['CLASSHOT', 'CSM']
2025-12-17 00:54:49,791 | INFO | root | 找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-17 00:54:49,791 | INFO | root | 处理 process_step: CLASSHOT，数据行数: 1187
2025-12-17 00:54:49,791 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 1187
2025-12-17 00:54:49,791 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-17 00:54:49,807 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-17 00:54:49,807 | INFO | root | ✅ CLASSHOT 的 Functional_bin Pareto 生成完成
2025-12-17 00:54:49,807 | INFO | root | 处理 process_step: CSM，数据行数: 322
2025-12-17 00:54:49,823 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 322
2025-12-17 00:54:49,823 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-17 00:54:49,823 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (22, 3)
2025-12-17 00:54:49,823 | INFO | root | ✅ CSM 的 Functional_bin Pareto 生成完成
2025-12-17 00:54:49,823 | INFO | root | 已按 process_step 分组，不生成总的 Functional_bin Pareto 表
2025-12-17 00:54:49,823 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 1187
2025-12-17 00:54:49,823 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-17 00:54:49,839 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (26, 3)
2025-12-17 00:54:49,839 | INFO | root | ✅ CLASSHOT 的 Interface_bin Pareto 生成完成
2025-12-17 00:54:49,839 | INFO | prd_lot_automation.data_processing | 构建 INTERFACE_BIN 数量表，数据行数: 322
2025-12-17 00:54:49,854 | WARNING | prd_lot_automation.data_processing | INTERFACE_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-17 00:54:49,854 | INFO | prd_lot_automation.data_processing | ✅ INTERFACE_BIN 数量表构建完成，形状: (11, 3)
2025-12-17 00:54:49,854 | INFO | root | ✅ CSM 的 Interface_bin Pareto 生成完成
2025-12-17 00:54:49,854 | INFO | root | 已按 process_step 分组，不生成总的 Interface_bin Pareto 表
2025-12-17 00:54:49,854 | INFO | root | 开始生成 Retest Bin Pareto（mut_within_subflow_latest_flag = N）
2025-12-17 00:54:49,854 | INFO | prd_lot_automation.data_processing | 应用过滤条件: mut_within_subflow_latest_flag = N，从 6075 行过滤到 1548 行
2025-12-17 00:54:49,854 | INFO | prd_lot_automation.data_processing | 应用过滤条件: SUBSTRUCTURE_ID = U1.U2，从 1548 行过滤到 516 行
2025-12-17 00:54:49,854 | INFO | prd_lot_automation.data_processing | 过滤完成：从原始 6075 行过滤到 516 行
2025-12-17 00:54:49,854 | INFO | root | Retest 数据中找到 2 个 process_step 类型: ['CLASSHOT', 'CSM']
2025-12-17 00:54:49,870 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 325
2025-12-17 00:54:49,870 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-17 00:54:49,870 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (67, 3)
2025-12-17 00:54:49,870 | INFO | root | ✅ CLASSHOT 的 Retest Bin Pareto 生成完成
2025-12-17 00:54:49,886 | INFO | prd_lot_automation.data_processing | 构建 FUNCTIONAL_BIN 数量表，数据行数: 191
2025-12-17 00:54:49,886 | WARNING | prd_lot_automation.data_processing | FUNCTIONAL_BIN: VISUAL_ID 存在非数值，使用去重计数
2025-12-17 00:54:49,886 | INFO | prd_lot_automation.data_processing | ✅ FUNCTIONAL_BIN 数量表构建完成，形状: (23, 3)
2025-12-17 00:54:49,886 | INFO | root | ✅ CSM 的 Retest Bin Pareto 生成完成
2025-12-17 00:54:49,886 | INFO | root | 已按 process_step 分组，不生成总的 Retest Bin Pareto 表
2025-12-17 00:54:49,886 | INFO | prd_lot_automation.report_builder | 生成报表：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-17.xlsx
2025-12-17 00:54:49,902 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Functional_bin Pareto 表
2025-12-17 00:54:50,002 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Functional_bin Pareto 表
2025-12-17 00:54:50,055 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Functional_bin Pareto 表
2025-12-17 00:54:50,063 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Interface_bin Pareto 表
2025-12-17 00:54:50,114 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Interface_bin Pareto 表
2025-12-17 00:54:50,151 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Interface_bin Pareto 表
2025-12-17 00:54:50,152 | INFO | prd_lot_automation.report_builder | 生成 2 个按 process_step 分组的 Retest Bin Pareto 表
2025-12-17 00:54:50,241 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CLASSHOT 的 Retest Bin Pareto 表
2025-12-17 00:54:50,292 | INFO | prd_lot_automation.report_builder | ✅ 已生成 CSM 的 Retest Bin Pareto 表
2025-12-17 00:54:51,946 | INFO | root | ✅ PRD LOT 自动化完成：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-17.xlsx
2025-12-17 00:54:51,946 | INFO | root | 关闭 SQLPathFinder...
2025-12-17 00:54:51,946 | INFO | prd_lot_automation.close_sqlpathfinder | 使用 win32gui 查找并关闭 SQLPathFinder 窗口...
2025-12-17 00:54:51,946 | INFO | prd_lot_automation.close_sqlpathfinder | 找到 2 个 SQLPathFinder 窗口
2025-12-17 00:54:51,946 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder Query Log (7189)
2025-12-17 00:54:52,369 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-17 00:54:52,878 | INFO | prd_lot_automation.close_sqlpathfinder | 关闭窗口: SQLPathFinder 3 (Main - 7189) - [Get_Sort_or_Test_Unit_Results_HBASE_By_Lot.VG2 (L0)]
2025-12-17 00:54:53,399 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 已发送 Alt+F4
2025-12-17 00:54:54,031 | INFO | prd_lot_automation.close_sqlpathfinder | ✅ 成功关闭 2 个 SQLPathFinder 窗口/进程
2025-12-17 00:54:54,031 | INFO | root | ================================================================================
2025-12-17 00:54:54,040 | INFO | root | 发送统一邮件
2025-12-17 00:54:54,040 | INFO | root | ================================================================================
2025-12-17 00:54:54,040 | INFO | prd_lot_automation.lot_reader | LOT 列表读取完成：8 个（原文件：C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Lot info.txt）
2025-12-17 00:54:54,056 | INFO | root | 尝试加载 PHI 文件: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\Prod_PHI.xlsx
2025-12-17 00:54:54,088 | INFO | root | 成功加载 PHI 数据: (12, 6)
2025-12-17 00:54:54,088 | INFO | root | PHI 数据列名: ['Operation', 'Sub Flow Step', 'Devrevstep', 'Yield PHI', 'TTG PHI', 'RCS PHI']
2025-12-17 00:54:54,088 | INFO | root | 处理合并单元格后的 PHI 数据:
2025-12-17 00:54:54,088 | INFO | root | PHI 数据前5行:
2025-12-17 00:54:54,088 | INFO | root |   行 0: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA2VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-17 00:54:54,088 | INFO | root |   行 1: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA4VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-17 00:54:54,088 | INFO | root |   行 2: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA5VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-17 00:54:54,088 | INFO | root |   行 3: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSHOT', 'Devrevstep': '4PXA6VDB', 'Yield PHI': 0.753, 'TTG PHI': 368.0, 'RCS PHI': 0.2}
2025-12-17 00:54:54,088 | INFO | root |   行 4: {'Operation': 6248.0, 'Sub Flow Step': 'CLASSCOLD', 'Devrevstep': '4PXA2VDB', 'Yield PHI': nan, 'TTG PHI': nan, 'RCS PHI': 0.1009}
2025-12-17 00:54:54,088 | INFO | root | ✅ PHI 数据加载成功，共 12 行
2025-12-17 00:54:54,104 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,104 | INFO | root | 第一行 PHI 值: {'Yield PHI': None, 'TTG PHI': None, 'RCS PHI': None}
2025-12-17 00:54:54,104 | INFO | root | 第一行数据: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,104 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,104 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,104 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,104 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,120 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,120 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,120 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH4VEB
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,120 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,135 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CLASSHOT, Devrevstep=4PLH5VEB
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,135 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,135 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,135 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH4VEB
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,135 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=CSM, Devrevstep=4PLH5VEB
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,135 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,151 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,151 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH2VEB
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,151 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH4VEB
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,151 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:54,167 | WARNING | root | ⚠️ 未找到匹配的 PHI 值: Operation=6248, Sub Flow Step=SCS, Devrevstep=4PLH5VEB
2025-12-17 00:54:54,167 | INFO | root |   PHI 文件中的 Operation 值: [6248.0, 6274.0]
2025-12-17 00:54:54,167 | INFO | root |   PHI 文件中的 Sub Flow Step 值: ['CLASSHOT', 'CLASSCOLD', 'PHMHOT']
2025-12-17 00:54:54,167 | INFO | root |   PHI 文件中的 Devrevstep 值: ['4PXA2VDB', '4PXA4VDB', '4PXA5VDB', '4PXA6VDB']
2025-12-17 00:54:58,352 | INFO | prd_lot_automation.mailer | Outlook HTML 邮件已发送
2025-12-17 00:54:58,618 | INFO | root | ================================================================================
2025-12-17 00:54:58,664 | INFO | root | ✅ 统一自动化完成
2025-12-17 00:54:58,691 | INFO | root |   Lab TP 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\Lab_TP_Performance_20251217.xlsx
2025-12-17 00:54:58,696 | INFO | root |   PRD LOT 报告: C:\Users\qibaiche\OneDrive - Intel Corporation\Documents\AI_Code\automation\test-data-auto-analysis\reports\LOT_Report_2025-12-17.xlsx
2025-12-17 00:54:58,696 | INFO | root | ================================================================================
